<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Markdown WebEditor</title>
    <meta name="description" content="Ein leichter Markdown Editor mit Reader Ansicht, Toolbar, Dark/Light Mode und Datei-Öffnen/Speichern." />

    <link rel="stylesheet" href="styles.css" />

    <!-- Favicons -->
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
    <link rel="shortcut icon" href="favicon.ico">

    <!-- Iconify for SVG icons -->
    <script src="https://code.iconify.design/iconify-icon/2.1.0/iconify-icon.min.js"></script>

    <!-- Highlight.js theme will be swapped dynamically based on theme -->
    <link id="hljs-theme" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.9.0/styles/github.min.css">

    <!-- Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.9/dist/purify.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.9.0/highlight.min.js"></script>
    <script src="vendor/pdfjs/pdf.js"></script>
    <script src="vendor/mammoth/mammoth.browser.min.js"></script>
    <script src="vendor/turndown/turndown.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/html2pdf.js@0.10.1/dist/html2pdf.bundle.min.js"></script>
  </head>
  <body>
    <header class="app-header">
      <div class="left">
        <img class="logo-img" src="Logo.png" alt="Markdown WebEditor Logo" />
        <span class="title" id="appTitle">Markdown WebEditor</span>
        <button id="undoBtn" class="has-icon" title="Rückgängig (Cmd/Ctrl+Z)"><iconify-icon aria-hidden="true" icon="lucide:undo-2"></iconify-icon><span class="btn-label">Rückgängig</span></button>
        <button id="redoBtn" class="has-icon" title="Wiederholen (Shift+Cmd/Ctrl+Z)"><iconify-icon aria-hidden="true" icon="lucide:redo-2"></iconify-icon><span class="btn-label">Wiederholen</span></button>
        <button id="templatesToggleBtn" class="has-icon" title="Vorlagen anzeigen" aria-haspopup="true" aria-expanded="false"><iconify-icon aria-hidden="true" icon="lucide:layout-template"></iconify-icon><span class="btn-label">Vorlagen</span></button>
      </div>
      <div class="center file-actions" role="toolbar" aria-label="Datei Aktionen">
        <button id="newBtn" class="has-icon" title="Neu (Cmd/Ctrl+N)"><iconify-icon aria-hidden="true" icon="lucide:file-plus"></iconify-icon><span class="btn-label">Neu</span></button>
        <button id="openBtn" class="has-icon" title="Öffnen (Cmd/Ctrl+O)"><iconify-icon aria-hidden="true" icon="lucide:folder-open"></iconify-icon><span class="btn-label">Öffnen</span></button>
        <button id="saveBtn" class="has-icon" title="Speichern (Cmd/Ctrl+S)"><iconify-icon aria-hidden="true" icon="lucide:save"></iconify-icon><span class="btn-label">Speichern</span></button>
        <button id="saveAsBtn" class="has-icon" title="Speichern unter (Shift+Cmd/Ctrl+S)"><iconify-icon aria-hidden="true" icon="mdi:content-save-edit-outline"></iconify-icon><span class="btn-label">Speichern unter</span></button>
        <div class="menu-group">
          <button id="importBtn" type="button" class="has-icon" title="Datei importieren" aria-haspopup="true" aria-expanded="false"><iconify-icon aria-hidden="true" icon="mdi:file-import-outline"></iconify-icon><span class="btn-label">Import</span></button>
          <div id="importMenu" class="toolbar-menu hidden" role="menu" aria-label="Datei importieren" aria-hidden="true">
            <button type="button" class="has-icon" data-import="pdf" role="menuitem"><iconify-icon aria-hidden="true" icon="mdi:file-pdf-box"></iconify-icon><span class="btn-label">PDF importieren</span></button>
            <button type="button" class="has-icon" data-import="docx" role="menuitem"><iconify-icon aria-hidden="true" icon="mdi:file-word-outline"></iconify-icon><span class="btn-label">Word importieren</span></button>
          </div>
        </div>
        <div class="menu-group">
          <button id="exportBtn" type="button" class="has-icon" title="Datei exportieren" aria-haspopup="true" aria-expanded="false"><iconify-icon aria-hidden="true" icon="mdi:file-export-outline"></iconify-icon><span class="btn-label">Export</span></button>
          <div id="exportMenu" class="toolbar-menu hidden" role="menu" aria-label="Datei exportieren" aria-hidden="true">
            <button type="button" class="has-icon" data-export="html" role="menuitem"><iconify-icon aria-hidden="true" icon="lucide:file-code"></iconify-icon><span class="btn-label">Als HTML exportieren</span></button>
            <button type="button" class="has-icon" data-export="pdf" role="menuitem"><iconify-icon aria-hidden="true" icon="mdi:file-pdf-box"></iconify-icon><span class="btn-label">Als PDF exportieren</span></button>
            <button type="button" class="has-icon" data-export="website" role="menuitem"><iconify-icon aria-hidden="true" icon="lucide:globe"></iconify-icon><span class="btn-label">Website erstellen</span></button>
          </div>
        </div>
        <input type="file" id="hiddenFile" accept=".md,.markdown,text/markdown" hidden />
        <input type="file" id="hiddenImage" accept="image/*" hidden />
        <input type="file" id="hiddenPdf" accept="application/pdf" hidden />
        <input type="file" id="hiddenDocx" accept="application/vnd.openxmlformats-officedocument.wordprocessingml.document,.docx" hidden />
      </div>
      <div class="right">
        <div class="view-toggle" role="group" aria-label="Ansicht">
          <button id="editViewBtn" class="has-icon active" title="Editor-Ansicht"><iconify-icon aria-hidden="true" icon="lucide:edit-3"></iconify-icon><span class="btn-label">Editor</span></button>
          <button id="splitViewBtn" class="has-icon" title="Geteilte Ansicht"><iconify-icon aria-hidden="true" icon="lucide:columns-2"></iconify-icon><span class="btn-label">Split</span></button>
          <button id="readerViewBtn" class="has-icon" title="Leser-Ansicht"><iconify-icon aria-hidden="true" icon="lucide:book-open"></iconify-icon><span class="btn-label">Reader</span></button>
        </div>
        <div class="theme-switcher">
          <button id="themeCycleBtn" class="icon-only" title="Theme wechseln" aria-label="Theme wechseln">
            <iconify-icon aria-hidden="true" icon="lucide:sun"></iconify-icon>
          </button>
          <div id="themeMenu" class="theme-menu hidden" role="menu" aria-label="Theme auswählen"></div>
        </div>
        <button
          id="fullscreenToggleBtn"
          class="icon-only"
          title="Vollbildmodus aktivieren"
          aria-label="Vollbildmodus umschalten"
          aria-pressed="false"
        >
          <iconify-icon aria-hidden="true" icon="lucide:maximize-2"></iconify-icon>
        </button>
        <button id="settingsBtn" class="icon-only" title="Einstellungen" aria-label="Einstellungen"><iconify-icon aria-hidden="true" icon="lucide:settings"></iconify-icon></button>
      </div>
    </header>

    <div class="toolbar" role="toolbar" aria-label="Formatierung">
      <button data-action="h1" class="has-icon" title="# Überschrift 1"><iconify-icon aria-hidden="true" icon="lucide:heading-1"></iconify-icon><span class="btn-label">H1</span></button>
      <button data-action="h2" class="has-icon" title="## Überschrift 2"><iconify-icon aria-hidden="true" icon="lucide:heading-2"></iconify-icon><span class="btn-label">H2</span></button>
      <button data-action="h3" class="has-icon" title="### Überschrift 3"><iconify-icon aria-hidden="true" icon="lucide:heading-3"></iconify-icon><span class="btn-label">H3</span></button>
      <span class="sep"></span>
      <button data-action="bold" class="has-icon" title="Fett (Cmd/Ctrl+B)"><iconify-icon aria-hidden="true" icon="lucide:bold"></iconify-icon><span class="btn-label">Fett</span></button>
      <button data-action="italic" class="has-icon" title="Kursiv (Cmd/Ctrl+I)"><iconify-icon aria-hidden="true" icon="lucide:italic"></iconify-icon><span class="btn-label">Kursiv</span></button>
      <button data-action="strike" class="has-icon" title="Durchgestrichen"><iconify-icon aria-hidden="true" icon="lucide:strikethrough"></iconify-icon><span class="btn-label">Strike</span></button>
      <button data-action="code" class="has-icon" title="Code (Inline)"><iconify-icon aria-hidden="true" icon="lucide:code"></iconify-icon><span class="btn-label">Code</span></button>
      <button data-action="codeblock" class="has-icon" title="Code Block"><iconify-icon aria-hidden="true" icon="lucide:code-2"></iconify-icon><span class="btn-label">Codeblock</span></button>
      <span class="sep"></span>
      <button data-action="ul" class="has-icon" title="Liste"><iconify-icon aria-hidden="true" icon="lucide:list"></iconify-icon><span class="btn-label">Liste</span></button>
      <button data-action="ol" class="has-icon" title="Nummerierte Liste"><iconify-icon aria-hidden="true" icon="lucide:list-ordered"></iconify-icon><span class="btn-label">Nummeriert</span></button>
      <button data-action="task" class="has-icon" title="Aufgabenliste"><iconify-icon aria-hidden="true" icon="mdi:checkbox-marked-outline"></iconify-icon><span class="btn-label">Task</span></button>
      <button data-action="quote" class="has-icon" title="Zitat"><iconify-icon aria-hidden="true" icon="lucide:quote"></iconify-icon><span class="btn-label">Zitat</span></button>
      <span class="sep"></span>
      <button data-action="link" class="has-icon" title="Link (Cmd/Ctrl+K)"><iconify-icon aria-hidden="true" icon="lucide:link"></iconify-icon><span class="btn-label">Link</span></button>
      <button data-action="image" class="has-icon" title="Bild einfügen"><iconify-icon aria-hidden="true" icon="lucide:image"></iconify-icon><span class="btn-label">Bild</span></button>
      <button data-action="table" class="has-icon" title="Tabelle"><iconify-icon aria-hidden="true" icon="mdi:table"></iconify-icon><span class="btn-label">Tabelle</span></button>
      <button data-action="hr" class="has-icon" title="Trennlinie"><iconify-icon aria-hidden="true" icon="lucide:minus"></iconify-icon><span class="btn-label">Linie</span></button>
      <span class="sep"></span>
      <button id="aiGenerateBtn" class="has-icon" title="KI: Text generieren (Cmd/Ctrl+G)"><iconify-icon aria-hidden="true" icon="mdi:robot-outline"></iconify-icon><span class="btn-label">Text Generieren</span></button>
      <button id="chatToggleBtn" class="has-icon" title="Chat ein-/ausblenden"><iconify-icon aria-hidden="true" icon="lucide:message-circle"></iconify-icon><span class="btn-label">Chat</span></button>
    </div>

    <!-- Inline AI generation panel -->
    <div id="aiInline" class="ai-inline hidden" aria-label="KI Generierung">
      <div class="row">
        <input id="aiPromptInput" type="text" placeholder="Beschreibe kurz, was generiert werden soll…" />
        <label class="chk"><input type="checkbox" id="aiUseSelection" /> Auswahl ersetzen</label>
        <button id="aiGenStartBtn" class="has-icon"><iconify-icon aria-hidden="true" icon="mdi:play-circle-outline"></iconify-icon><span class="btn-label">Start</span></button>
        <button id="aiGenAbortBtn" class="secondary has-icon" disabled><iconify-icon aria-hidden="true" icon="mdi:stop-circle-outline"></iconify-icon><span class="btn-label">Abbrechen</span></button>
        <button id="aiGenResetBtn" class="secondary has-icon" disabled><iconify-icon aria-hidden="true" icon="mdi:backup-restore"></iconify-icon><span class="btn-label">Zurücksetzen</span></button>
      </div>
      <div class="row">
        <label>Preset
          <select id="aiPresetSelect"></select>
        </label>
        <button id="aiPresetSettingsBtn" class="secondary has-icon" type="button" title="KI-Presets verwalten">
          <iconify-icon aria-hidden="true" icon="lucide:sparkles"></iconify-icon>
          <span class="btn-label">KI-Presets</span>
        </button>
        <span id="aiGenInfo" class="muted"></span>
      </div>
    </div>

    <main id="workspace" class="layout layout-edit" aria-label="Arbeitsbereich">
      <section class="editor-pane" aria-label="Editor">
        <textarea id="editor" placeholder="# Willkommen zum Markdown WebEditor

Hier kannst du Markdown schreiben. Wähle oben die gewünschte Formatierung oder schreibe direkt los. Öffne bestehende .md-Dateien, speichere sie lokal oder exportiere als HTML.

## Tipps für den Start
- Wechsel bei Bedarf zwischen Editor-, Split- und Reader-Ansicht.
- Ziehe .md-Dateien direkt hierher oder nutze Neu/Öffnen in der Toolbar.
- Ziehe Bilder hierher oder füge sie ein (Paste), der passende Markdown-Link entsteht automatisch.
- Wechsle Themes über die Sonne/Mond-Schaltfläche und passe Details in den Einstellungen an.
- Öffne die KI-Werkzeuge (✨) für Ideen, Umformulierungen oder Zusammenfassungen.

## Tastenkürzel
- Cmd/Ctrl+S speichert, Shift+Cmd/Ctrl+S speichert unter
- Cmd/Ctrl+O öffnet, Cmd/Ctrl+N erstellt ein neues Dokument
- Cmd/Ctrl+Z macht rückgängig, Shift+Cmd/Ctrl+Z wiederholt

Viel Spaß beim Schreiben! ✨"></textarea>
      </section>
      <section class="preview-pane" aria-label="Vorschau">
        <div id="preview" class="markdown-body"></div>
      </section>
    </main>

    <footer class="statusbar" aria-live="polite">
      <span id="status">Bereit</span>
      <span id="cursorPos"></span>
      <span id="wordCount"></span>
      <span id="fileName"></span>
    </footer>

    <!-- Onboarding Tutorial -->
    <div id="onboardingOverlay" class="onboarding hidden" aria-hidden="true">
      <section class="onboarding-dialog" role="dialog" aria-modal="true" aria-labelledby="onboardingTitle">
        <header class="onboarding-header">
          <span id="onboardingStepCounter" class="onboarding-counter"></span>
          <button id="onboardingSkipBtn" type="button" class="secondary">Überspringen</button>
        </header>
        <div class="onboarding-body">
          <h2 id="onboardingTitle"></h2>
          <p id="onboardingDescription" class="onboarding-description"></p>
          <ul id="onboardingStepList" class="onboarding-list"></ul>
        </div>
        <div id="onboardingDots" class="onboarding-dots" aria-hidden="true"></div>
        <footer class="onboarding-actions">
          <button id="onboardingPrevBtn" type="button" class="secondary">Zurück</button>
          <span class="spacer"></span>
          <button id="onboardingNextBtn" type="button" class="primary">Weiter</button>
        </footer>
      </section>
    </div>
    <div id="templatesOverlay" class="templates-overlay hidden" aria-hidden="true"></div>
    <aside
      id="templatesPanel"
      class="templates-panel hidden"
      role="dialog"
      aria-label="Vorlagen"
      aria-modal="true"
    >
      <header class="templates-header">
        <strong>Vorlagen</strong>
        <label class="template-search">
          <iconify-icon aria-hidden="true" icon="lucide:search"></iconify-icon>
          <input id="templateSearch" type="search" placeholder="Vorlagen durchsuchen" aria-label="Vorlagen durchsuchen" />
        </label>
        <button id="templatesCloseBtn" class="icon-only templates-close" title="Vorlagen schließen" aria-label="Vorlagen schließen">
          <iconify-icon aria-hidden="true" icon="lucide:x"></iconify-icon>
        </button>
      </header>
      <div class="templates-body">
        <nav id="templateCategories" class="template-categories" role="tablist" aria-label="Vorlagenkategorien"></nav>
        <div class="templates-main">
          <div class="template-list-wrapper" role="presentation">
            <ul id="templateList" class="template-list" role="listbox" aria-label="Vorlagen"></ul>
          </div>
          <article id="templatePreview" class="template-preview" aria-live="polite">
            <div class="template-preview-empty" id="templatePreviewEmpty">
              <iconify-icon aria-hidden="true" icon="lucide:files"></iconify-icon>
              <p>Wähle links eine Vorlage aus, um eine Vorschau zu sehen.</p>
            </div>
            <div class="template-preview-content hidden" id="templatePreviewContent">
              <header>
                <h3 id="templatePreviewTitle"></h3>
                <div class="template-preview-actions">
                  <button id="templateFavoriteBtn" class="icon-only" title="Als Favorit markieren" aria-label="Als Favorit markieren">
                    <iconify-icon aria-hidden="true" icon="lucide:star"></iconify-icon>
                  </button>
                  <button id="templateInsertBtn" class="has-icon">
                    <iconify-icon aria-hidden="true" icon="lucide:clipboard-plus"></iconify-icon>
                    <span class="btn-label">In Editor einfügen</span>
                  </button>
                </div>
              </header>
              <p id="templatePreviewDescription" class="muted"></p>
              <pre id="templatePreviewSample"></pre>
            </div>
          </article>
        </div>
      </div>
    </aside>

    <!-- Chat Panel -->
    <div id="chatOverlay" class="chat-overlay hidden" aria-hidden="true"></div>
    <aside id="chatPanel" class="chat-panel hidden" role="dialog" aria-label="Chat" aria-modal="true">
      <header class="chat-header">
        <strong>Chat</strong>
        <div class="spacer"></div>
        <span id="chatModelBadge" class="chat-model-badge"></span>
        <div class="spacer"></div>
        <button id="chatCloseBtn" class="icon-only" title="Schließen" aria-label="Schließen"><iconify-icon aria-hidden="true" icon="lucide:x"></iconify-icon></button>
      </header>
      
      <section id="chatMessages" class="chat-messages" aria-live="polite"></section>
      <section class="chat-input">
        <ul id="chatSuggestions" class="chat-suggestions" aria-label="Vorgeschlagene Prompts">
          <li>
            <button type="button" data-prompt="Fasse die wichtigsten Punkte zusammen. Bitte fasse die Kernaussagen knapp zusammen."><strong>Fasse die wichtigsten Punkte zusammen.</strong> Bitte fasse die Kernaussagen knapp zusammen.</button>
          </li>
          <li>
            <button type="button" data-prompt="Worum geht es hier? Bitte beschreibe den Kontext in wenigen Sätzen."><strong>Worum geht es hier?</strong> Bitte beschreibe den Kontext in wenigen Sätzen.</button>
          </li>
          <li>
            <button type="button" data-prompt="Welche offenen Fragen gibt es noch? Liste verbleibende Unklarheiten auf."><strong>Welche offenen Fragen gibt es noch?</strong> Liste verbleibende Unklarheiten auf.</button>
          </li>
          <li>
            <button type="button" data-prompt="Welche nächsten Schritte empfiehlst du? Formuliere konkrete To-dos."><strong>Welche nächsten Schritte empfiehlst du?</strong> Formuliere konkrete To-dos.</button>
          </li>
        </ul>
        <textarea id="chatInput" rows="2" placeholder="Frage eingeben und Enter senden…"></textarea>
        <div class="row">
          <button id="chatSendBtn" class="has-icon"><iconify-icon aria-hidden="true" icon="lucide:send"></iconify-icon><span class="btn-label">Senden</span></button>
          <button id="chatAbortBtn" class="secondary has-icon" disabled><iconify-icon aria-hidden="true" icon="mdi:stop-circle-outline"></iconify-icon><span class="btn-label">Abbrechen</span></button>
          <button id="chatClearBtn" class="secondary has-icon"><iconify-icon aria-hidden="true" icon="mdi:eraser"></iconify-icon><span class="btn-label">Leeren</span></button>
          <button id="editorContextBtn" class="secondary has-icon" title="Erlaube Zugriff auf den aktuellen Editor-Inhalt"><iconify-icon aria-hidden="true" icon="mdi:file-document-outline"></iconify-icon><span class="btn-label">Editor-Kontext: EIN</span></button>
          <span id="editorContextInfo" class="muted"></span>
        </div>
      </section>
    </aside>

    <!-- Settings Panel -->
    <div id="settingsOverlay" class="settings-overlay hidden" aria-hidden="true"></div>
    <aside id="settingsPanel" class="settings-panel hidden" role="dialog" aria-label="Einstellungen" aria-modal="true">
      <header class="chat-header">
        <strong>Einstellungen</strong>
        <div class="spacer"></div>
        <button id="settingsCloseBtn" class="icon-only" title="Schließen" aria-label="Schließen"><iconify-icon aria-hidden="true" icon="lucide:x"></iconify-icon></button>
      </header>
      <div class="settings-body">
        <nav class="settings-nav" role="tablist" aria-orientation="vertical">
          <button class="nav-item has-icon active" data-tab="general" role="tab" aria-selected="true">
            <iconify-icon aria-hidden="true" icon="lucide:sliders-horizontal"></iconify-icon>
            <span class="btn-label">Allgemein</span>
          </button>
          <button class="nav-item has-icon" data-tab="user-context" role="tab" aria-selected="false">
            <iconify-icon aria-hidden="true" icon="lucide:user-circle"></iconify-icon>
            <span class="btn-label">Mein Kontext</span>
          </button>
          <button class="nav-item has-icon" data-tab="presets" role="tab" aria-selected="false">
            <iconify-icon aria-hidden="true" icon="lucide:sparkles"></iconify-icon>
            <span class="btn-label">KI‑Presets</span>
          </button>
          <button class="nav-item has-icon" data-tab="providers" role="tab" aria-selected="false">
            <iconify-icon aria-hidden="true" icon="lucide:server"></iconify-icon>
            <span class="btn-label">KI‑Anbieter</span>
          </button>
          <button class="nav-item has-icon" data-tab="info" role="tab" aria-selected="false">
            <iconify-icon aria-hidden="true" icon="lucide:info"></iconify-icon>
            <span class="btn-label">Info</span>
          </button>
          <button class="nav-item has-icon" data-tab="updates" role="tab" aria-selected="false">
            <iconify-icon aria-hidden="true" icon="lucide:git-commit"></iconify-icon>
            <span class="btn-label">Neuerungen</span>
          </button>
        </nav>
        <div class="settings-content">
        <section class="chat-settings settings-tab" data-tab="general" role="tabpanel">
            <label class="chk"><input type="checkbox" id="prefReaderInput" checked /> Reader‑Eingabe aktivieren</label>
            <label class="chk"><input type="checkbox" id="prefStickyTools" checked /> Werkzeugleisten immer sichtbar</label>
            <label class="chk"><input type="checkbox" id="prefAiInlineAutoOpen" /> KI‑Leiste beim Öffnen automatisch zeigen</label>
            <label>
              Standardansicht
              <select id="prefDefaultView" aria-label="Standardansicht">
                <option value="edit">Editor</option>
                <option value="split">Split</option>
                <option value="reader">Reader</option>
              </select>
            </label>
            <div class="settings-group">
              <h4>Konfiguration</h4>
              <p class="muted">Exportiere oder importiere alle Einstellungen als JSON‑Datei.</p>
              <div class="row">
                <button id="settingsConfigExportBtn" class="secondary">Konfiguration exportieren</button>
                <button id="settingsConfigImportBtn" class="secondary">Konfiguration importieren</button>
                <input type="file" id="settingsConfigImportFile" accept="application/json" hidden />
              </div>
            </div>
        </section>
        <section class="chat-settings settings-tab hidden" data-tab="user-context" role="tabpanel" aria-label="Persönlicher Kontext">
          <p id="userContextIntro" class="muted">Formuliere hier Hintergrundinfos, damit KI-Antworten besser zu dir, deinem Stil und deiner Zielgruppe passen.</p>
          <label class="chk">
            <input
              type="checkbox"
              id="prefUserContextEnabled"
              checked
              aria-describedby="userContextIntro"
              aria-controls="userContextFields"
            />
            Nutzerkontext für KI-Anfragen verwenden
          </label>
          <div id="userContextFields" class="user-context-fields">
            <div class="settings-group">
              <h4>Über mich &amp; Rolle</h4>
              <p class="muted">Beschreibe deine Position, Hintergründe oder Aufgaben, damit die KI dich richtig einordnen kann.</p>
              <textarea id="prefUserContextProfile" rows="3" placeholder="z. B. Produktmanagerin in einem SaaS-Startup, Schwerpunkt Kundenerfolg…"></textarea>
            </div>
            <div class="settings-group">
              <h4>Schreibstil &amp; Ton</h4>
              <p class="muted">Wie sollen Antworten klingen? Teile gewünschte Tonalität, Formalitätsgrad oder Sprachbesonderheiten.</p>
              <textarea id="prefUserContextStyle" rows="4" placeholder="z. B. freundlich, motivierend, gendergerechte Sprache, kurze Sätze…"></textarea>
            </div>
            <div class="settings-group">
              <h4>Zielgruppe oder Empfänger</h4>
              <p class="muted">Für wen sind die Texte gedacht? Erwähne Branche, Erfahrungslevel oder besondere Erwartungen.</p>
              <textarea id="prefUserContextAudience" rows="3" placeholder="z. B. neue Kund:innen ohne technisches Vorwissen, deutschsprachig…"></textarea>
            </div>
            <div class="settings-group">
              <h4>Besondere Hinweise</h4>
              <p class="muted">Halte Do’s &amp; Don’ts, bevorzugte Quellen oder andere Vorgaben fest.</p>
              <textarea id="prefUserContextInstructions" rows="4" placeholder="z. B. keine Emojis, immer Quellen angeben, Markdown-Listen bevorzugen…"></textarea>
            </div>
          </div>
        </section>
        <section class="chat-settings settings-tab hidden" data-tab="presets" role="tabpanel" aria-label="KI-Presets">
          <p class="muted">Presets sind gespeicherte Aufforderungen für die KI-Generieren-Funktion. Damit kannst du wiederkehrende Aufgaben mit einem Klick auslösen.</p>
          <div class="settings-group">
            <h4>Preset</h4>
            <label>
              Preset auswählen
              <select id="settingsPresetSelect"></select>
            </label>
            <div class="row">
              <button id="settingsPresetSaveBtn" class="secondary">Speichern/Anlegen</button>
              <button id="settingsPresetNewBtn" class="secondary">Neu</button>
              <button id="settingsPresetDuplicateBtn" class="secondary">Duplizieren</button>
              <button id="settingsPresetRenameBtn" class="secondary">Umbenennen</button>
              <button id="settingsPresetDeleteBtn" class="secondary">Löschen</button>
            </div>
          </div>
          <div class="settings-group">
            <h4>Inhalt</h4>
            <label>
              Name
              <input id="settingsPresetName" type="text" placeholder="Preset-Name" />
            </label>
            <label>
              Prompt
              <textarea id="settingsPresetPrompt" rows="8" placeholder="Prompt-Text…"></textarea>
            </label>
          </div>

          <div id="settingsPresetStatus" class="muted"></div>
        </section>
          <section class="chat-settings settings-tab hidden" data-tab="providers" role="tabpanel" aria-label="KI‑Anbieter Einstellungen">
            <div class="settings-group">
              <h4>Anbieter</h4>
              <label>
                KI‑Anbieter auswählen
                <select id="aiProvider">
                  <option value="openai">OpenAI</option>
                  <option value="claude">Anthropic Claude</option>
                  <option value="ollama">Ollama (lokal)</option>
                  <option value="gemini">Google Gemini</option>
                  <option value="mistral">Mistral AI</option>
                </select>
              </label>
              <div class="row">
                <label class="chk"><input type="checkbox" id="chatStreamToggle" checked /> Stream</label>
              </div>
            </div>

            <div id="openaiSettingsGroup" class="settings-group">
              <h4>OpenAI</h4>
              <label>
                API‑Key
                <input type="password" id="openaiApiKeyInput" placeholder="sk-..." autocomplete="off" />
                <div class="muted">
                  Kein Schlüssel? <a href="https://platform.openai.com/api-keys" target="_blank" rel="noopener noreferrer">API‑Keys erstellen</a>
                </div>
              </label>
              <label>
                Basis‑URL
                <input type="url" id="openaiBaseInput" placeholder="https://api.openai.com/v1" />
              </label>
              <label>
                Modell
                <select id="openaiModelSelect"><option value="">Modelle laden…</option></select>
                <input type="text" id="openaiModelInput" placeholder="gpt-4o-mini (optional, manuell)" />
              </label>
              <div class="row">
                <button id="openaiSaveBtn" class="has-icon"><iconify-icon aria-hidden="true" icon="lucide:save"></iconify-icon><span class="btn-label">Speichern</span></button>
                <button id="openaiTestBtn" class="has-icon"><iconify-icon aria-hidden="true" icon="mdi:power-plug-outline"></iconify-icon><span class="btn-label">Verbindung testen</span></button>
              </div>
              <div id="openaiStatus" class="ollama-status" aria-live="polite"></div>
            </div>

            <div id="claudeSettingsGroup" class="settings-group" style="display: none;">
              <h4>Anthropic Claude</h4>
              <label>
                API‑Key
                <input type="password" id="claudeApiKeyInput" placeholder="sk-ant-..." autocomplete="off" />
                <div class="muted">
                  Kein Schlüssel? <a href="https://console.anthropic.com/settings/keys" target="_blank" rel="noopener noreferrer">API‑Keys erstellen</a>
                </div>
              </label>
              <label>
                Basis‑URL
                <input type="url" id="claudeBaseInput" placeholder="https://api.anthropic.com" />
              </label>
              <label>
                Modell
                <select id="claudeModelSelect"><option value="">Modelle laden…</option></select>
                <input type="text" id="claudeModelInput" placeholder="claude-3-5-sonnet-latest (optional, manuell)" />
              </label>
              <div class="row">
                <button id="claudeSaveBtn" class="has-icon"><iconify-icon aria-hidden="true" icon="lucide:save"></iconify-icon><span class="btn-label">Speichern</span></button>
                <button id="claudeTestBtn" class="has-icon"><iconify-icon aria-hidden="true" icon="mdi:power-plug-outline"></iconify-icon><span class="btn-label">Verbindung testen</span></button>
              </div>
              <div id="claudeStatus" class="ollama-status" aria-live="polite"></div>
            </div>

            <div id="ollamaSettingsGroup" class="settings-group">
              <h4>Ollama</h4>
              <label>
                Ollama URL
                <input type="url" id="ollamaUrlInput" placeholder="http://localhost:11434" />
              </label>
              <label>
                Modell
                <select id="ollamaModelSelect"><option value="">Modelle laden…</option></select>
                <input type="text" id="ollamaModelInput" placeholder="llama3.1:8b (optional, manuell)" />
              </label>
              <div class="row">
                <button id="ollamaSaveBtn" class="has-icon"><iconify-icon aria-hidden="true" icon="lucide:save"></iconify-icon><span class="btn-label">Speichern</span></button>
                <button id="ollamaTestBtn" class="has-icon"><iconify-icon aria-hidden="true" icon="mdi:power-plug-outline"></iconify-icon><span class="btn-label">Verbindung testen</span></button>
              </div>
              <div id="ollamaStatus" class="ollama-status" aria-live="polite"></div>
            </div>

            <div id="geminiSettingsGroup" class="settings-group" style="display: none;">
              <h4>Google Gemini</h4>
              <label>
                API‑Key
                <input type="password" id="geminiApiKeyInput" placeholder="AIza..." autocomplete="off" />
                <div class="muted">
                  Kein Schlüssel? <a href="https://aistudio.google.com/api-keys" target="_blank" rel="noopener noreferrer">API‑Keys erstellen</a>
                </div>
              </label>
              <label>
                Modell
                <select id="geminiModelSelect"><option value="">Modelle laden…</option></select>
                <input type="text" id="geminiModelInput" placeholder="gemini-1.5-flash (optional, manuell)" />
              </label>
              <div class="row">
                <button id="geminiSaveBtn" class="has-icon"><iconify-icon aria-hidden="true" icon="lucide:save"></iconify-icon><span class="btn-label">Speichern</span></button>
                <button id="geminiTestBtn" class="has-icon"><iconify-icon aria-hidden="true" icon="mdi:power-plug-outline"></iconify-icon><span class="btn-label">Verbindung testen</span></button>
              </div>
              <div id="geminiStatus" class="ollama-status" aria-live="polite"></div>
            </div>

            <div id="mistralSettingsGroup" class="settings-group" style="display: none;">
              <h4>Mistral AI</h4>
              <label>
                API‑Key
                <input type="password" id="mistralApiKeyInput" placeholder="mistral-xxxxxxxx" autocomplete="off" />
                <div class="muted">
                  Kein Schlüssel? <a href="https://console.mistral.ai/" target="_blank" rel="noopener noreferrer">API‑Keys erstellen</a>
                </div>
              </label>
              <label>
                Modell
                <select id="mistralModelSelect"><option value="">Modelle laden…</option></select>
                <input type="text" id="mistralModelInput" placeholder="mistral-small-latest (optional, manuell)" />
              </label>
              <div class="row">
                <button id="mistralSaveBtn" class="has-icon"><iconify-icon aria-hidden="true" icon="lucide:save"></iconify-icon><span class="btn-label">Speichern</span></button>
                <button id="mistralTestBtn" class="has-icon"><iconify-icon aria-hidden="true" icon="mdi:power-plug-outline"></iconify-icon><span class="btn-label">Verbindung testen</span></button>
              </div>
              <div id="mistralStatus" class="ollama-status" aria-live="polite"></div>
            </div>

          </section>
        <section class="chat-settings settings-tab hidden" data-tab="info" role="tabpanel" aria-label="Info">
          <div class="info-panel">
            <img id="infoAvatar" class="info-avatar" alt="GitHub Avatar" src="" />
            <div class="info-name" id="infoName">GitHub: Anes-03</div>
            <div class="row">
              <a id="infoRepoBtn" class="btn" href="https://github.com/Anes-03/Markdown-WebEditor" target="_blank" rel="noopener noreferrer">
                <iconify-icon aria-hidden="true" icon="lucide:github"></iconify-icon>
                <span class="btn-label">Projekt‑Repository öffnen</span>
              </a>
            </div>
          </div>
          <div class="settings-group">
            <h4>App</h4>
            <div class="row" style="flex-wrap: wrap; gap: 10px;">
              <div class="muted">Theme</div>
              <div id="infoTheme"></div>
              <div class="muted">Ansicht</div>
              <div id="infoView"></div>
            </div>
            <div class="row" style="flex-wrap: wrap; gap: 10px;">
              <div class="muted">KI‑Anbieter</div>
              <div id="infoProvider"></div>
            </div>
          </div>
          <div class="settings-group">
            <h4>Tastenkürzel</h4>
            <ul class="shortcuts">
              <li>
                <span class="keys"><kbd>Cmd</kbd>/<kbd>Ctrl</kbd> + <kbd>S</kbd></span>
                <span class="desc">Speichern</span>
              </li>
              <li>
                <span class="keys"><kbd>Shift</kbd> + <kbd>Cmd</kbd>/<kbd>Ctrl</kbd> + <kbd>S</kbd></span>
                <span class="desc">Speichern unter</span>
              </li>
              <li>
                <span class="keys"><kbd>Cmd</kbd>/<kbd>Ctrl</kbd> + <kbd>O</kbd></span>
                <span class="desc">Öffnen</span>
              </li>
              <li>
                <span class="keys"><kbd>Cmd</kbd>/<kbd>Ctrl</kbd> + <kbd>N</kbd></span>
                <span class="desc">Neu</span>
              </li>
              <li>
                <span class="keys"><kbd>Cmd</kbd>/<kbd>Ctrl</kbd> + <kbd>B</kbd></span>
                <span class="desc">Fett</span>
              </li>
              <li>
                <span class="keys"><kbd>Cmd</kbd>/<kbd>Ctrl</kbd> + <kbd>I</kbd></span>
                <span class="desc">Kursiv</span>
              </li>
              <li>
                <span class="keys"><kbd>Cmd</kbd>/<kbd>Ctrl</kbd> + <kbd>K</kbd></span>
                <span class="desc">Link einfügen</span>
              </li>
              <li>
                <span class="keys"><kbd>Cmd</kbd>/<kbd>Ctrl</kbd> + <kbd>G</kbd> oder <kbd>Cmd</kbd>/<kbd>Ctrl</kbd> + <kbd>Enter</kbd></span>
                <span class="desc">KI generieren</span>
              </li>
              <li>
                <span class="keys"><kbd>Cmd</kbd>/<kbd>Ctrl</kbd> + <kbd>Z</kbd></span>
                <span class="desc">Rückgängig</span>
              </li>
              <li>
                <span class="keys"><kbd>Shift</kbd> + <kbd>Cmd</kbd>/<kbd>Ctrl</kbd> + <kbd>Z</kbd></span>
                <span class="desc">Wiederholen</span>
              </li>
            </ul>
          </div>
          <div class="settings-group">
            <h4>Hinweise & Datenschutz</h4>
            <ul>
              <li>Deine Dokumente bleiben lokal im Browser, Autosave nutzt LocalStorage.</li>
              <li>Beim Einbetten von Bildern werden Daten‑URLs im Dokument gespeichert.</li>
              <li>KI‑Funktionen senden Inhalte an den gewählten Anbieter (z. B. Ollama lokal, OpenAI, Claude, Gemini oder Mistral), sofern aktiviert.</li>
            </ul>
          </div>
          <div class="settings-group">
            <h4>Credits</h4>
            <ul>
              <li>Markdown: marked</li>
              <li>Sicherheit: DOMPurify</li>
              <li>Syntax‑Highlighting: highlight.js</li>
              <li>PDF Export: html2pdf.js</li>
              <li>Icons: Iconify</li>
            </ul>
          </div>
          <div class="settings-group">
            <h4>Feedback</h4>
            <form id="feedbackForm" class="feedback-form">
              <div class="form-row">
                <label for="feedbackName">Name</label>
                <input type="text" id="feedbackName" name="name" placeholder="Dein Name" autocomplete="name" />
              </div>
              <div class="form-row">
                <label for="feedbackEmail">E‑Mail</label>
                <input type="email" id="feedbackEmail" name="email" placeholder="deine@mail.de" autocomplete="email" />
              </div>
              <div class="form-row">
                <label for="feedbackMessage">Nachricht<span aria-hidden="true">*</span></label>
                <textarea id="feedbackMessage" name="message" rows="4" required placeholder="Dein Feedback…"></textarea>
              </div>
              <button type="submit" id="feedbackSubmit" class="secondary">Feedback senden</button>
            </form>
            <div id="feedbackHint" class="muted">Beim Senden wird dein Mail‑Programm mit allen Angaben geöffnet.</div>
          </div>
        </section>
        <section id="updatesPanel" class="chat-settings settings-tab hidden" data-tab="updates" role="tabpanel" aria-label="Neuerungen">
          <div class="settings-group updates-group">
            <div class="updates-header">
              <h4>Aktuelle Änderungen</h4>
              <span id="updatesStatus" class="muted" aria-live="polite">Noch nicht geladen.</span>
            </div>
            <ol id="updatesList" class="updates-list" aria-live="polite"></ol>
            <button id="updatesReloadBtn" class="updates-reload has-icon" type="button">
              <iconify-icon aria-hidden="true" icon="lucide:refresh-cw"></iconify-icon>
              <span class="btn-label">Neu laden</span>
            </button>
          </div>
        </section>
        </div>
      </div>
      <footer class="settings-footer">
        <div class="spacer"></div>
        <button id="settingsSaveBtn">Speichern</button>
      </footer>
    </aside>

    <div id="websiteOverlay" class="website-overlay hidden" aria-hidden="true"></div>
    <aside
      id="websiteModal"
      class="website-modal hidden"
      role="dialog"
      aria-modal="true"
      aria-labelledby="websiteModalTitle"
      aria-hidden="true"
      tabindex="-1"
    >
      <header class="chat-header">
        <strong id="websiteModalTitle">Website-Vorschau</strong>
        <div class="spacer"></div>
        <button id="websiteCloseBtn" class="icon-only" title="Schließen" aria-label="Schließen">
          <iconify-icon aria-hidden="true" icon="lucide:x"></iconify-icon>
        </button>
      </header>
      <div class="website-modal-body">
        <p id="websiteStatus" class="website-status" aria-live="polite">Die KI erstellt eine Vorschau für deine Website…</p>
        <div class="website-preview-wrapper">
          <iframe
            id="websitePreviewFrame"
            title="Generierte Website-Vorschau"
            sandbox="allow-same-origin"
          ></iframe>
        </div>
      </div>
      <footer class="website-modal-footer">
        <div class="website-modal-footer-group">
          <button id="websiteCopyHtmlBtn" class="secondary has-icon" type="button">
            <iconify-icon aria-hidden="true" icon="lucide:copy"></iconify-icon>
            <span class="btn-label">Code kopieren</span>
          </button>
          <button id="websiteDownloadBtn" class="secondary has-icon" type="button">
            <iconify-icon aria-hidden="true" icon="lucide:download"></iconify-icon>
            <span class="btn-label">Als Datei herunterladen</span>
          </button>
        </div>
        <div class="spacer"></div>
        <div class="website-modal-footer-group">
          <button id="websiteRegenerateBtn" class="secondary has-icon" type="button">
            <iconify-icon aria-hidden="true" icon="mdi:refresh"></iconify-icon>
            <span class="btn-label">Neu generieren</span>
          </button>
          <button id="websiteCloseFooterBtn" class="has-icon" type="button">
            <iconify-icon aria-hidden="true" icon="lucide:check"></iconify-icon>
            <span class="btn-label">Fertig</span>
          </button>
        </div>
      </footer>
    </aside>
    <script src="data/templates.js"></script>
    <script src="app.js"></script>
  </body>
</html>
