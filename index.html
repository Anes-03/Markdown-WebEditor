<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Markdown WebEditor</title>
    <meta name="description" content="Ein leichter Markdown Editor mit Reader Ansicht, Toolbar, Dark/Light Mode und Datei-Öffnen/Speichern." />

    <link rel="stylesheet" href="styles.css" />

    <!-- Favicons -->
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
    <link rel="shortcut icon" href="favicon.ico">

    <!-- Iconify for SVG icons -->
    <script src="https://code.iconify.design/iconify-icon/2.1.0/iconify-icon.min.js"></script>

    <!-- Highlight.js theme will be swapped dynamically based on theme -->
    <link id="hljs-theme" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.9.0/styles/github.min.css">

    <!-- Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.9/dist/purify.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.9.0/highlight.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script src="vendor/pdfjs/pdf.js"></script>
    <script src="vendor/mammoth/mammoth.browser.min.js"></script>
    <script src="vendor/turndown/turndown.js"></script>
    <script src="vendor/diff-match-patch/diff-match-patch.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/html2pdf.js@0.10.1/dist/html2pdf.bundle.min.js"></script>
  </head>
  <body>
    <header class="app-header">
      <div class="branding">
        <img class="logo-img" src="Logo.png" alt="Markdown WebEditor Logo" />
        <span class="title" id="appTitle">Markdown WebEditor &mdash; 252425 Homelab</span>
        <span class="file-name" id="fileName" aria-live="polite"></span>
      </div>
      <div class="left">
        <button id="undoBtn" class="has-icon" title="Rückgängig (Cmd/Ctrl+Z)" aria-label="Rückgängig (Cmd/Ctrl+Z)"><iconify-icon aria-hidden="true" icon="lucide:undo-2"></iconify-icon><span class="btn-label">Rückgängig</span></button>
        <button id="redoBtn" class="has-icon" title="Wiederholen (Shift+Cmd/Ctrl+Z)" aria-label="Wiederholen (Shift+Cmd/Ctrl+Z)"><iconify-icon aria-hidden="true" icon="lucide:redo-2"></iconify-icon><span class="btn-label">Wiederholen</span></button>
      </div>
      <div class="center file-actions" role="toolbar" aria-label="Datei Aktionen">
        <button id="templatesToggleBtn" class="has-icon" title="Vorlagen anzeigen" aria-haspopup="true" aria-expanded="false"><iconify-icon aria-hidden="true" icon="lucide:layout-template"></iconify-icon><span class="btn-label">Vorlagen</span></button>
        <button id="newBtn" class="has-icon" title="Neu (Cmd/Ctrl+N)"><iconify-icon aria-hidden="true" icon="lucide:file-plus"></iconify-icon><span class="btn-label">Neu</span></button>
        <button id="openBtn" class="has-icon" title="Öffnen (Cmd/Ctrl+O)"><iconify-icon aria-hidden="true" icon="lucide:folder-open"></iconify-icon><span class="btn-label">Öffnen</span></button>
        <button id="saveBtn" class="has-icon" title="Speichern (Cmd/Ctrl+S)"><iconify-icon aria-hidden="true" icon="lucide:save"></iconify-icon><span class="btn-label">Speichern</span></button>
        <button id="saveAsBtn" class="has-icon" title="Speichern unter (Shift+Cmd/Ctrl+S)"><iconify-icon aria-hidden="true" icon="mdi:content-save-edit-outline"></iconify-icon><span class="btn-label">Speichern unter</span></button>
        <div class="menu-group">
          <button id="importBtn" type="button" class="has-icon" title="Datei importieren" aria-haspopup="true" aria-expanded="false"><iconify-icon aria-hidden="true" icon="mdi:file-import-outline"></iconify-icon><span class="btn-label">Import</span></button>
          <div id="importMenu" class="toolbar-menu hidden" role="menu" aria-label="Datei importieren" aria-hidden="true">
            <button type="button" class="has-icon" data-import="pdf" role="menuitem"><iconify-icon aria-hidden="true" icon="mdi:file-pdf-box"></iconify-icon><span class="btn-label">PDF importieren</span></button>
            <button type="button" class="has-icon" data-import="docx" role="menuitem"><iconify-icon aria-hidden="true" icon="mdi:file-word-outline"></iconify-icon><span class="btn-label">Word importieren</span></button>
          </div>
        </div>
        <div class="menu-group">
          <button id="exportBtn" type="button" class="has-icon" title="Datei exportieren" aria-haspopup="true" aria-expanded="false"><iconify-icon aria-hidden="true" icon="mdi:file-export-outline"></iconify-icon><span class="btn-label">Export</span></button>
          <div id="exportMenu" class="toolbar-menu hidden" role="menu" aria-label="Datei exportieren" aria-hidden="true">
            <button type="button" class="has-icon" data-export="html" role="menuitem"><iconify-icon aria-hidden="true" icon="lucide:file-code"></iconify-icon><span class="btn-label">Als HTML exportieren</span></button>
            <button type="button" class="has-icon" data-export="pdf" role="menuitem"><iconify-icon aria-hidden="true" icon="mdi:file-pdf-box"></iconify-icon><span class="btn-label">Als PDF exportieren</span></button>
            <button type="button" class="has-icon" data-export="website" role="menuitem"><iconify-icon aria-hidden="true" icon="lucide:globe"></iconify-icon><span class="btn-label">Website erstellen</span></button>
          </div>
        </div>
        <button id="printBtn" class="has-icon" title="Datei drucken (Cmd/Ctrl+P)"><iconify-icon aria-hidden="true" icon="lucide:printer"></iconify-icon><span class="btn-label">Drucken</span></button>
        <div class="ai-actions" role="group" aria-label="Lernen und KI">
          <div class="menu-group">
            <button
              id="learningBtn"
              type="button"
              class="has-icon"
              title="Lerninhalte generieren"
              aria-haspopup="true"
              aria-expanded="false"
            >
              <iconify-icon aria-hidden="true" icon="mdi:school-outline"></iconify-icon>
              <span class="btn-label">Lernen</span>
            </button>
            <div
              id="learningMenu"
              class="toolbar-menu hidden"
              role="menu"
              aria-label="Lerninhalte generieren"
              aria-hidden="true"
            >
              <button type="button" class="has-icon" data-learning="flashcards" role="menuitem">
                <iconify-icon aria-hidden="true" icon="mdi:cards-outline"></iconify-icon>
                <span class="btn-label">Karteikarten</span>
              </button>
              <button type="button" class="has-icon" data-learning="cloze" role="menuitem">
                <iconify-icon aria-hidden="true" icon="mdi:form-textbox"></iconify-icon>
                <span class="btn-label">Lückentext</span>
              </button>
              <button type="button" class="has-icon" data-learning="quiz-mc" role="menuitem">
                <iconify-icon aria-hidden="true" icon="mdi:format-list-bulleted"></iconify-icon>
                <span class="btn-label">Quiz (Multiple Choice)</span>
              </button>
              <button type="button" class="has-icon" data-learning="quiz-free" role="menuitem">
                <iconify-icon aria-hidden="true" icon="mdi:pencil-outline"></iconify-icon>
                <span class="btn-label">Quiz (Freitext)</span>
              </button>
              <button type="button" class="has-icon" data-learning="learning-game" role="menuitem">
                <iconify-icon aria-hidden="true" icon="mdi:controller-classic-outline"></iconify-icon>
                <span class="btn-label">Lernspiel</span>
              </button>
            </div>
          </div>
          <button id="aiGenerateBtn" class="has-icon" title="KI: Assistent (Cmd/Ctrl+G)"><iconify-icon aria-hidden="true" icon="mdi:robot-outline"></iconify-icon><span class="btn-label">Assistent</span></button>
          <button id="chatToggleBtn" class="has-icon" title="Chat ein-/ausblenden"><iconify-icon aria-hidden="true" icon="lucide:message-circle"></iconify-icon><span class="btn-label">Chat</span></button>
        </div>
        <input type="file" id="hiddenFile" accept=".md,.markdown,text/markdown" hidden />
        <input type="file" id="hiddenImage" accept="image/*" hidden />
        <input type="file" id="hiddenAudio" accept="audio/*" hidden />
        <input type="file" id="hiddenVideo" accept="video/*" hidden />
        <input type="file" id="hiddenPdf" accept="application/pdf" hidden />
        <input
          type="file"
          id="templateUploadFile"
          accept=".md,.markdown,.txt,text/markdown,text/plain"
          multiple
          hidden
        />
        <input type="file" id="hiddenDocx" accept="application/vnd.openxmlformats-officedocument.wordprocessingml.document,.docx" hidden />
      </div>
      <div class="right">
        <div class="view-toggle" role="group" aria-label="Ansicht">
          <button id="editViewBtn" class="has-icon active" title="Editor-Ansicht"><iconify-icon aria-hidden="true" icon="lucide:edit-3"></iconify-icon><span class="btn-label">Editor</span></button>
          <button id="splitViewBtn" class="has-icon" title="Geteilte Ansicht"><iconify-icon aria-hidden="true" icon="lucide:columns-2"></iconify-icon><span class="btn-label">Split</span></button>
          <button id="readerViewBtn" class="has-icon" title="Leser-Ansicht"><iconify-icon aria-hidden="true" icon="lucide:book-open"></iconify-icon><span class="btn-label">Reader</span></button>
        </div>
        <button
          id="readAloudBtn"
          class="icon-only"
          title="Reader-Inhalt vorlesen"
          aria-label="Reader-Inhalt vorlesen"
          aria-pressed="false"
        >
          <iconify-icon aria-hidden="true" icon="lucide:volume-2"></iconify-icon>
        </button>
        <div class="theme-switcher">
          <button id="themeCycleBtn" class="icon-only" title="Theme wechseln" aria-label="Theme wechseln">
            <iconify-icon aria-hidden="true" icon="lucide:sun"></iconify-icon>
          </button>
          <div id="themeMenu" class="theme-menu hidden" role="menu" aria-label="Theme auswählen"></div>
        </div>
        <button
          id="versionsToggleBtn"
          class="icon-only"
          title="Versionen anzeigen"
          aria-label="Versionen anzeigen"
          aria-pressed="false"
          type="button"
        >
          <iconify-icon aria-hidden="true" icon="lucide:history"></iconify-icon>
        </button>
        <button
          id="fullscreenToggleBtn"
          class="icon-only"
          title="Vollbildmodus aktivieren"
          aria-label="Vollbildmodus umschalten"
          aria-pressed="false"
        >
          <iconify-icon aria-hidden="true" icon="lucide:maximize-2"></iconify-icon>
        </button>
        <button id="settingsBtn" class="icon-only" title="Einstellungen" aria-label="Einstellungen"><iconify-icon aria-hidden="true" icon="lucide:settings"></iconify-icon></button>
      </div>
    </header>

    <div class="toolbar" role="toolbar" aria-label="Formatierung">
      <button data-action="h1" class="has-icon" title="# Überschrift 1"><iconify-icon aria-hidden="true" icon="lucide:heading-1"></iconify-icon><span class="btn-label">H1</span></button>
      <button data-action="h2" class="has-icon" title="## Überschrift 2"><iconify-icon aria-hidden="true" icon="lucide:heading-2"></iconify-icon><span class="btn-label">H2</span></button>
      <button data-action="h3" class="has-icon" title="### Überschrift 3"><iconify-icon aria-hidden="true" icon="lucide:heading-3"></iconify-icon><span class="btn-label">H3</span></button>
      <div class="heading-menu-group">
        <button id="headingMoreBtn" type="button" class="has-icon" title="Weitere Überschriften" aria-haspopup="true" aria-expanded="false">
          <iconify-icon aria-hidden="true" icon="lucide:chevron-down"></iconify-icon>
          <span class="btn-label">Mehr</span>
        </button>
        <div id="headingMenu" class="toolbar-menu hidden" role="menu" aria-label="Weitere Überschriften" aria-hidden="true">
          <button type="button" class="has-icon" data-action="h4" role="menuitem"><iconify-icon aria-hidden="true" icon="lucide:heading-4"></iconify-icon><span class="btn-label">H4</span></button>
          <button type="button" class="has-icon" data-action="h5" role="menuitem"><iconify-icon aria-hidden="true" icon="lucide:heading-5"></iconify-icon><span class="btn-label">H5</span></button>
          <button type="button" class="has-icon" data-action="h6" role="menuitem"><iconify-icon aria-hidden="true" icon="lucide:heading-6"></iconify-icon><span class="btn-label">H6</span></button>
        </div>
      </div>
      <span class="sep"></span>
      <button data-action="bold" class="has-icon" title="Fett (Cmd/Ctrl+B)"><iconify-icon aria-hidden="true" icon="lucide:bold"></iconify-icon><span class="btn-label">Fett</span></button>
      <button data-action="italic" class="has-icon" title="Kursiv (Cmd/Ctrl+I)"><iconify-icon aria-hidden="true" icon="lucide:italic"></iconify-icon><span class="btn-label">Kursiv</span></button>
      <button data-action="strike" class="has-icon" title="Durchgestrichen"><iconify-icon aria-hidden="true" icon="lucide:strikethrough"></iconify-icon><span class="btn-label">Strike</span></button>
      <button data-action="text-color" class="has-icon" title="Textfarbe anpassen" aria-haspopup="true" aria-expanded="false">
        <iconify-icon aria-hidden="true" icon="lucide:palette"></iconify-icon>
        <span class="btn-label">Farbe</span>
      </button>
      <button data-action="text-highlight" class="has-icon" title="Text hervorheben" aria-haspopup="true" aria-expanded="false">
        <iconify-icon aria-hidden="true" icon="lucide:highlighter"></iconify-icon>
        <span class="btn-label">Markieren</span>
      </button>
      <span class="sep"></span>
      <button data-action="align-left" class="has-icon" title="Text linksbündig"><iconify-icon aria-hidden="true" icon="lucide:align-left"></iconify-icon><span class="btn-label">Links</span></button>
      <button data-action="align-center" class="has-icon" title="Text zentriert"><iconify-icon aria-hidden="true" icon="lucide:align-center"></iconify-icon><span class="btn-label">Zentriert</span></button>
      <button data-action="align-right" class="has-icon" title="Text rechtsbündig"><iconify-icon aria-hidden="true" icon="lucide:align-right"></iconify-icon><span class="btn-label">Rechts</span></button>
      <span class="sep"></span>
      <button data-action="code" class="has-icon" title="Code (Inline)"><iconify-icon aria-hidden="true" icon="lucide:code"></iconify-icon><span class="btn-label">Code</span></button>
      <button data-action="codeblock" class="has-icon" title="Code Block"><iconify-icon aria-hidden="true" icon="lucide:code-2"></iconify-icon><span class="btn-label">Codeblock</span></button>
      <span class="sep"></span>
      <button data-action="ul" class="has-icon" title="Liste"><iconify-icon aria-hidden="true" icon="lucide:list"></iconify-icon><span class="btn-label">Liste</span></button>
      <button data-action="ol" class="has-icon" title="Nummerierte Liste"><iconify-icon aria-hidden="true" icon="lucide:list-ordered"></iconify-icon><span class="btn-label">Nummeriert</span></button>
      <button data-action="task" class="has-icon" title="Aufgabenliste"><iconify-icon aria-hidden="true" icon="mdi:checkbox-marked-outline"></iconify-icon><span class="btn-label">Task</span></button>
      <button data-action="quote" class="has-icon" title="Zitat"><iconify-icon aria-hidden="true" icon="lucide:quote"></iconify-icon><span class="btn-label">Zitat</span></button>
      <span class="sep"></span>
      <button data-action="link" class="has-icon" title="Link (Cmd/Ctrl+K)"><iconify-icon aria-hidden="true" icon="lucide:link"></iconify-icon><span class="btn-label">Link</span></button>
      <button data-action="image" class="has-icon" title="Bild einfügen"><iconify-icon aria-hidden="true" icon="lucide:image"></iconify-icon><span class="btn-label">Bild</span></button>
      <button data-action="audio" class="has-icon" title="Audio einfügen"><iconify-icon aria-hidden="true" icon="lucide:audio-lines"></iconify-icon><span class="btn-label">Audio</span></button>
      <div class="menu-group">
        <button
          id="videoMenuBtn"
          type="button"
          class="has-icon"
          title="Video einfügen"
          aria-haspopup="true"
          aria-expanded="false"
        >
          <iconify-icon aria-hidden="true" icon="lucide:video"></iconify-icon>
          <span class="btn-label">Video</span>
        </button>
        <div id="videoMenu" class="toolbar-menu hidden" role="menu" aria-label="Video einfügen" aria-hidden="true">
          <button type="button" class="has-icon" data-video-action="file" role="menuitem">
            <iconify-icon aria-hidden="true" icon="lucide:upload"></iconify-icon>
            <span class="btn-label">Eigene Videodatei einfügen</span>
          </button>
          <button type="button" class="has-icon" data-video-action="url" role="menuitem">
            <iconify-icon aria-hidden="true" icon="lucide:clapperboard"></iconify-icon>
            <span class="btn-label">YouTube/Vimeo- oder Direktlink einbetten</span>
          </button>
        </div>
      </div>
      <button data-action="table" class="has-icon" title="Tabelle"><iconify-icon aria-hidden="true" icon="mdi:table"></iconify-icon><span class="btn-label">Tabelle</span></button>
      <button data-action="mermaid" class="has-icon" title="Diagramm einfügen"><iconify-icon aria-hidden="true" icon="mdi:chart-timeline-variant"></iconify-icon><span class="btn-label">Diagramm</span></button>
      <button data-action="hr" class="has-icon" title="Trennlinie"><iconify-icon aria-hidden="true" icon="lucide:minus"></iconify-icon><span class="btn-label">Linie</span></button>
      <span class="sep"></span>
      <div
        id="colorMenu"
        class="toolbar-menu color-menu hidden"
        role="menu"
        aria-label="Farbauswahl"
        aria-hidden="true"
      >
        <div id="colorMenuLabel" class="color-menu-label">Farbe wählen</div>
        <div class="color-swatches" role="none">
          <button type="button" class="color-swatch" data-color="#000000" style="--swatch-color:#000000" role="menuitem" title="Schwarz" aria-label="Schwarz"></button>
          <button type="button" class="color-swatch" data-color="#1f2933" style="--swatch-color:#1f2933" role="menuitem" title="Dunkelgrau" aria-label="Dunkelgrau"></button>
          <button type="button" class="color-swatch" data-color="#ef4444" style="--swatch-color:#ef4444" role="menuitem" title="Rot" aria-label="Rot"></button>
          <button type="button" class="color-swatch" data-color="#f97316" style="--swatch-color:#f97316" role="menuitem" title="Orange" aria-label="Orange"></button>
          <button type="button" class="color-swatch" data-color="#facc15" style="--swatch-color:#facc15" role="menuitem" title="Gelb" aria-label="Gelb"></button>
          <button type="button" class="color-swatch" data-color="#22c55e" style="--swatch-color:#22c55e" role="menuitem" title="Grün" aria-label="Grün"></button>
          <button type="button" class="color-swatch" data-color="#0ea5e9" style="--swatch-color:#0ea5e9" role="menuitem" title="Blau" aria-label="Blau"></button>
          <button type="button" class="color-swatch" data-color="#6366f1" style="--swatch-color:#6366f1" role="menuitem" title="Indigo" aria-label="Indigo"></button>
          <button type="button" class="color-swatch" data-color="#ec4899" style="--swatch-color:#ec4899" role="menuitem" title="Pink" aria-label="Pink"></button>
          <button type="button" class="color-swatch" data-color="#6b7280" style="--swatch-color:#6b7280" role="menuitem" title="Grau" aria-label="Grau"></button>
          <button type="button" class="color-swatch" data-color="#ffffff" style="--swatch-color:#ffffff" role="menuitem" title="Weiß" aria-label="Weiß"></button>
          <button type="button" class="color-swatch" data-color="#fff59d" style="--swatch-color:#fff59d" role="menuitem" title="Gelb (hell)" aria-label="Gelb (hell)"></button>
        </div>
        <button id="colorCustomBtn" type="button" class="has-icon" role="menuitem">
          <iconify-icon aria-hidden="true" icon="lucide:dropper"></iconify-icon>
          <span class="btn-label">Benutzerdefiniert…</span>
        </button>
        <input type="color" id="colorMenuCustomInput" class="toolbar-color-picker" aria-label="Eigene Farbe wählen" value="#1f2933" />
      </div>
    </div>

    <!-- Inline AI generation panel -->
    <div id="aiInline" class="ai-inline hidden" aria-label="KI Generierung">
      <div class="row">
        <input id="aiPromptInput" type="text" placeholder="Beschreibe kurz, was generiert werden soll…" />
        <label class="chk"><input type="checkbox" id="aiUseSelection" /> Auswahl ersetzen</label>
        <button id="aiGenStartBtn" class="has-icon"><iconify-icon aria-hidden="true" icon="mdi:play-circle-outline"></iconify-icon><span class="btn-label">Start</span></button>
        <button id="aiGenAbortBtn" class="secondary has-icon" disabled><iconify-icon aria-hidden="true" icon="mdi:stop-circle-outline"></iconify-icon><span class="btn-label">Abbrechen</span></button>
        <button id="aiGenResetBtn" class="secondary has-icon" disabled><iconify-icon aria-hidden="true" icon="mdi:backup-restore"></iconify-icon><span class="btn-label">Zurücksetzen</span></button>
      </div>
      <div class="row">
        <div class="preset-picker" id="aiPresetPicker">
          <span class="preset-picker-label">Preset</span>
          <button id="aiPresetToggle" class="preset-toggle has-icon" type="button" aria-haspopup="listbox" aria-expanded="false">
            <span class="preset-toggle-text">
              <span id="aiPresetActiveName" class="preset-active-name">Preset auswählen</span>
              <span id="aiPresetActiveDetails" class="preset-active-details">Schnellstart für KI-Aufgaben</span>
            </span>
            <iconify-icon aria-hidden="true" icon="lucide:chevron-down"></iconify-icon>
          </button>
          <div id="aiPresetMenu" class="preset-menu hidden" role="listbox" aria-label="KI-Presets"></div>
        </div>
        <button id="aiPresetSettingsBtn" class="secondary has-icon" type="button" title="KI-Presets verwalten">
          <iconify-icon aria-hidden="true" icon="lucide:sparkles"></iconify-icon>
          <span class="btn-label">KI-Presets</span>
        </button>
        <span id="aiGenInfo" class="muted"></span>
      </div>
    </div>

    <main id="workspace" class="layout layout-edit" aria-label="Arbeitsbereich">
      <section class="editor-pane" aria-label="Editor">
        <textarea id="editor" placeholder="# Willkommen zum Markdown WebEditor

Hier kannst du Markdown schreiben. Wähle oben die gewünschte Formatierung oder schreibe direkt los. Öffne bestehende .md-Dateien, speichere sie lokal oder exportiere als HTML.

## Tipps für den Start
- Wechsel bei Bedarf zwischen Editor-, Split- und Reader-Ansicht.
- Ziehe .md-Dateien direkt hierher oder nutze Neu/Öffnen in der Toolbar.
- Ziehe Bilder hierher oder füge sie ein (Paste), der passende Markdown-Link entsteht automatisch.
- Wechsle Themes über die Sonne/Mond-Schaltfläche und passe Details in den Einstellungen an.
- Öffne die KI-Werkzeuge (✨) für Ideen, Umformulierungen oder Zusammenfassungen.

## Tastenkürzel
- Cmd/Ctrl+S speichert, Shift+Cmd/Ctrl+S speichert unter
- Cmd/Ctrl+O öffnet, Cmd/Ctrl+N erstellt ein neues Dokument
- Cmd/Ctrl+Z macht rückgängig, Shift+Cmd/Ctrl+Z wiederholt

Viel Spaß beim Schreiben! ✨"></textarea>
      </section>
      <section class="preview-pane" aria-label="Vorschau">
        <div id="preview" class="markdown-body"></div>
      </section>
    </main>

    <footer class="statusbar" aria-live="polite">
      <span id="status">Bereit</span>
      <span id="cursorPos"></span>
      <span id="wordCount"></span>
      <span id="statusFileName" class="muted"></span>
    </footer>

    <!-- Onboarding Tutorial -->
    <div id="onboardingOverlay" class="onboarding hidden" aria-hidden="true">
      <section class="onboarding-dialog" role="dialog" aria-modal="true" aria-labelledby="onboardingTitle">
        <header class="onboarding-header">
          <span id="onboardingStepCounter" class="onboarding-counter"></span>
          <button id="onboardingSkipBtn" type="button" class="secondary">Überspringen</button>
        </header>
        <div class="onboarding-body">
          <h2 id="onboardingTitle"></h2>
          <p id="onboardingDescription" class="onboarding-description"></p>
          <ul id="onboardingStepList" class="onboarding-list"></ul>
        </div>
        <div id="onboardingDots" class="onboarding-dots" aria-hidden="true"></div>
        <footer class="onboarding-actions">
          <button id="onboardingPrevBtn" type="button" class="secondary">Zurück</button>
          <span class="spacer"></span>
          <button id="onboardingNextBtn" type="button" class="primary">Weiter</button>
        </footer>
      </section>
    </div>
    <div id="templatesOverlay" class="templates-overlay hidden" aria-hidden="true"></div>
    <aside
      id="templatesPanel"
      class="templates-panel hidden"
      role="dialog"
      aria-label="Vorlagen"
      aria-modal="true"
    >
      <header class="templates-header">
        <strong>Vorlagen</strong>
        <button id="templateAiGenerateBtn" class="has-icon template-ai-btn" type="button">
          <iconify-icon aria-hidden="true" icon="lucide:sparkles"></iconify-icon>
          <span class="btn-label">KI-Vorlage</span>
        </button>
        <button id="templateUploadBtn" class="has-icon template-upload-btn" type="button">
          <iconify-icon aria-hidden="true" icon="lucide:upload"></iconify-icon>
          <span class="btn-label">Vorlage hochladen</span>
        </button>
        <label class="template-search">
          <iconify-icon aria-hidden="true" icon="lucide:search"></iconify-icon>
          <input id="templateSearch" type="search" placeholder="Vorlagen durchsuchen" aria-label="Vorlagen durchsuchen" />
        </label>
        <button id="templatesCloseBtn" class="icon-only templates-close" title="Vorlagen schließen" aria-label="Vorlagen schließen">
          <iconify-icon aria-hidden="true" icon="lucide:x"></iconify-icon>
        </button>
      </header>
      <section
        id="templateAiComposer"
        class="template-ai-composer hidden"
        aria-label="KI-Vorlage erstellen"
        aria-live="polite"
      >
        <div class="template-ai-composer-header">
          <label for="templateAiPromptInput">Beschreibe, was die KI als Vorlage liefern soll</label>
          <button id="templateAiPromptCancel" type="button" class="icon-only" title="Eingabe schließen" aria-label="Eingabe schließen">
            <iconify-icon aria-hidden="true" icon="lucide:x"></iconify-icon>
          </button>
        </div>
        <textarea
          id="templateAiPromptInput"
          rows="3"
          placeholder="z. B. Ich benötige einen Stundenplan für die Schule"
          aria-label="Prompt für KI-Vorlage"
        ></textarea>
        <p id="templateAiPromptMessage" class="template-ai-prompt-message muted hidden"></p>
        <div class="template-ai-composer-actions">
          <button id="templateAiPromptSubmit" type="button" class="has-icon primary">
            <iconify-icon aria-hidden="true" icon="lucide:sparkles"></iconify-icon>
            <span class="btn-label">Vorlage generieren</span>
          </button>
          <button id="templateAiPromptClose" type="button" class="secondary">
            Schließen
          </button>
        </div>
      </section>
      <div class="templates-body">
        <nav id="templateCategories" class="template-categories" role="tablist" aria-label="Vorlagenkategorien"></nav>
        <div class="templates-main">
          <div class="template-list-wrapper" role="presentation">
            <ul id="templateList" class="template-list" role="listbox" aria-label="Vorlagen"></ul>
          </div>
          <article id="templatePreview" class="template-preview" aria-live="polite">
            <div class="template-preview-empty" id="templatePreviewEmpty">
              <iconify-icon aria-hidden="true" icon="lucide:files"></iconify-icon>
              <p>Wähle links eine Vorlage aus, um eine Vorschau zu sehen.</p>
            </div>
            <div class="template-preview-content hidden" id="templatePreviewContent">
              <header>
                <h3 id="templatePreviewTitle"></h3>
                <div class="template-preview-actions">
                  <button id="templateFavoriteBtn" class="icon-only" title="Als Favorit markieren" aria-label="Als Favorit markieren">
                    <iconify-icon aria-hidden="true" icon="lucide:star"></iconify-icon>
                  </button>
                  <button
                    id="templateRenameBtn"
                    class="icon-only template-rename-btn hidden"
                    type="button"
                    title="Vorlage umbenennen"
                    aria-label="Vorlage umbenennen"
                  >
                    <iconify-icon aria-hidden="true" icon="lucide:edit-3"></iconify-icon>
                  </button>
                  <button
                    id="templateDeleteBtn"
                    class="icon-only template-delete-btn hidden"
                    type="button"
                    title="Vorlage löschen"
                    aria-label="Vorlage löschen"
                  >
                    <iconify-icon aria-hidden="true" icon="lucide:trash-2"></iconify-icon>
                  </button>
                  <button id="templatePreviewExpandBtn" class="has-icon secondary" type="button">
                    <iconify-icon aria-hidden="true" icon="lucide:expand"></iconify-icon>
                    <span class="btn-label">Vorschau</span>
                  </button>
                  <button id="templateInsertBtn" class="has-icon">
                    <iconify-icon aria-hidden="true" icon="lucide:clipboard-plus"></iconify-icon>
                    <span class="btn-label">In Editor einfügen</span>
                  </button>
                </div>
              </header>
              <p id="templatePreviewDescription" class="muted"></p>
              <p id="templateAiStatus" class="template-ai-status hidden muted"></p>
              <pre id="templatePreviewSample"></pre>
            </div>
          </article>
        </div>
      </div>
    </aside>

    <div
      id="templatePreviewModal"
      class="template-preview-modal hidden"
      role="dialog"
      aria-modal="true"
      aria-labelledby="templatePreviewModalTitle"
    >
      <div class="template-preview-modal-content">
        <header>
          <h3 id="templatePreviewModalTitle"></h3>
          <button
            id="templatePreviewModalClose"
            class="icon-only"
            type="button"
            title="Vorschau schließen"
            aria-label="Vorschau schließen"
          >
            <iconify-icon aria-hidden="true" icon="lucide:x"></iconify-icon>
          </button>
        </header>
        <p id="templatePreviewModalDescription" class="muted"></p>
        <pre id="templatePreviewModalBody"></pre>
      </div>
    </div>

    <div id="versionsOverlay" class="versions-overlay hidden" aria-hidden="true"></div>
    <aside
      id="versionsPanel"
      class="versions-panel hidden"
      role="complementary"
      aria-label="Versionen"
      aria-hidden="true"
    >
      <header class="versions-header">
        <div>
          <strong>Versionen</strong>
          <span id="versionsStatus" class="muted" aria-live="polite"></span>
        </div>
        <button id="versionsCloseBtn" class="icon-only" title="Schließen" aria-label="Versionspanel schließen" type="button">
          <iconify-icon aria-hidden="true" icon="lucide:x"></iconify-icon>
        </button>
      </header>
      <section class="versions-actions" aria-label="Snapshot erstellen">
        <label class="versions-note">
          <span>Notiz</span>
          <input id="versionsNoteInput" type="text" placeholder="z. B. Statusmeldung" />
        </label>
        <button id="versionsSnapshotBtn" class="has-icon" type="button">
          <iconify-icon aria-hidden="true" icon="lucide:save"></iconify-icon>
          <span class="btn-label">Snapshot speichern</span>
        </button>
      </section>
      <section class="versions-body">
        <ol id="versionsList" class="versions-list" aria-label="Gespeicherte Versionen"></ol>
        <div class="versions-empty" id="versionsEmptyHint" hidden>Es wurden noch keine Snapshots gespeichert.</div>
      </section>
      <section class="versions-diff" aria-label="Diff-Vorschau">
        <header class="versions-diff-header">
          <strong>Diff</strong>
          <span id="versionsDiffMeta" class="muted"></span>
        </header>
        <pre id="versionsDiff" class="versions-diff-content" aria-live="polite"></pre>
        <div class="versions-diff-actions">
          <button id="versionsRestoreBtn" class="has-icon" type="button" disabled>
            <iconify-icon aria-hidden="true" icon="lucide:undo-2"></iconify-icon>
            <span class="btn-label">Version wiederherstellen</span>
          </button>
        </div>
      </section>
    </aside>
    <!-- Table builder dialog -->
    <div id="tableDialogOverlay" class="modal-overlay hidden" aria-hidden="true">
      <div id="tableDialog" class="table-dialog" role="dialog" aria-modal="true" aria-labelledby="tableDialogTitle">
        <form id="tableDialogForm" class="table-dialog-form">
          <header class="modal-header">
            <h2 id="tableDialogTitle">Tabelle einfügen</h2>
            <button type="button" id="tableDialogCloseBtn" class="icon-only" title="Schließen" aria-label="Schließen">
              <iconify-icon aria-hidden="true" icon="lucide:x"></iconify-icon>
            </button>
          </header>
          <div class="modal-body">
            <p class="muted">Lege Größe und Inhalte der Tabelle fest. Die erste Zeile wird als Kopfzeile verwendet.</p>
            <div class="table-dialog-controls">
              <label>
                Spalten
                <input id="tableColsInput" type="number" min="1" max="10" value="3" />
              </label>
              <label>
                Zeilen
                <input id="tableRowsInput" type="number" min="2" max="15" value="3" />
              </label>
              <span class="controls-spacer"></span>
              <button type="button" id="tableAddColBtn" class="secondary has-icon" title="Spalte hinzufügen">
                <iconify-icon aria-hidden="true" icon="lucide:plus"></iconify-icon>
                <span class="btn-label">Spalte</span>
              </button>
              <button type="button" id="tableAddRowBtn" class="secondary has-icon" title="Zeile hinzufügen">
                <iconify-icon aria-hidden="true" icon="lucide:plus"></iconify-icon>
                <span class="btn-label">Zeile</span>
              </button>
            </div>
            <div id="tableBuilderGrid" class="table-builder-grid" role="application" aria-label="Tabelleninhalt bearbeiten"></div>
          </div>
          <footer class="modal-footer">
            <button type="button" id="tableDialogCancelBtn" class="secondary">Abbrechen</button>
            <button type="submit" id="tableDialogInsertBtn" class="primary has-icon">
              <iconify-icon aria-hidden="true" icon="mdi:table"></iconify-icon>
              <span class="btn-label">Einfügen</span>
            </button>
          </footer>
        </form>
      </div>
    </div>

    <!-- Link dialog -->
    <div id="linkDialogOverlay" class="modal-overlay hidden" aria-hidden="true">
      <div id="linkDialog" class="link-dialog" role="dialog" aria-modal="true" aria-labelledby="linkDialogTitle">
        <form id="linkDialogForm" class="link-dialog-form">
          <header class="modal-header">
            <h2 id="linkDialogTitle">Link einfügen</h2>
            <button type="button" id="linkDialogCloseBtn" class="icon-only" title="Schließen" aria-label="Schließen">
              <iconify-icon aria-hidden="true" icon="lucide:x"></iconify-icon>
            </button>
          </header>
          <div class="modal-body">
            <p class="muted">Lege Linktext, URL und optional einen Titel fest. Relative Pfade & Anker sind ebenfalls möglich.</p>
            <label>
              Linktext
              <input id="linkTextInput" type="text" placeholder="z. B. Dokumentation" />
            </label>
            <label>
              URL
              <input id="linkUrlInput" type="text" inputmode="url" placeholder="https://beispiel.de" required />
            </label>
            <label>
              Titel (optional)
              <input id="linkTitleInput" type="text" placeholder="Tooltip oder Zusatzinfo" />
            </label>
          </div>
          <footer class="modal-footer">
            <p id="linkDialogStatus" class="link-dialog-status" role="status" aria-live="polite"></p>
            <button type="button" id="linkDialogCancelBtn" class="secondary">Abbrechen</button>
            <button type="submit" id="linkDialogInsertBtn" class="primary has-icon" disabled>
              <iconify-icon aria-hidden="true" icon="lucide:link-2"></iconify-icon>
              <span class="btn-label">Einfügen</span>
            </button>
          </footer>
        </form>
      </div>
    </div>

    <!-- Mermaid diagram dialog -->
    <div id="mermaidDialogOverlay" class="modal-overlay hidden" aria-hidden="true">
      <div id="mermaidDialog" class="mermaid-dialog" role="dialog" aria-modal="true" aria-labelledby="mermaidDialogTitle">
        <form id="mermaidDialogForm" class="mermaid-dialog-form">
          <header class="modal-header">
            <div class="modal-title-group">
              <h2 id="mermaidDialogTitle">Diagramm erstellen</h2>
              <span class="badge badge-experimental" aria-label="Experimentelle Funktion">Experimentell</span>
            </div>
            <button type="button" id="mermaidDialogCloseBtn" class="icon-only" title="Schließen" aria-label="Schließen">
              <iconify-icon aria-hidden="true" icon="lucide:x"></iconify-icon>
            </button>
          </header>
          <div class="modal-body">
            <p class="muted">Nutze den experimentellen Diagramm-Editor, um Typ und Code anzupassen, bevor du den Inhalt in dein Dokument übernimmst.</p>
            <div class="mermaid-dialog-controls">
              <label>
                Diagrammtyp
                <select id="mermaidTypeSelect">
                  <option value="flowchart">Flussdiagramm</option>
                  <option value="sequence">Sequenzdiagramm</option>
                  <option value="class">Klassendiagramm</option>
                  <option value="state">Zustandsdiagramm</option>
                  <option value="gantt">Gantt-Diagramm</option>
                  <option value="pie">Tortendiagramm</option>
                </select>
              </label>
              <label id="mermaidOrientationField">
                Diagrammrichtung
                <select id="mermaidOrientationSelect">
                  <option value="TD">Oben → unten (TD)</option>
                  <option value="LR">Links → rechts (LR)</option>
                  <option value="BT">Unten → oben (BT)</option>
                  <option value="RL">Rechts → links (RL)</option>
                </select>
              </label>
              <button type="button" id="mermaidTemplateResetBtn" class="secondary">Standard wiederherstellen</button>
            </div>
            <div id="mermaidBuilder" class="mermaid-builder hidden">
              <div class="mermaid-builder-header">
                <label class="builder-toggle">
                  <input type="checkbox" id="mermaidBuilderEnabled" />
                  <span>Grafischen Editor aktivieren</span>
                </label>
                <button type="button" id="mermaidBuilderResetBtn" class="secondary">Builder zurücksetzen</button>
              </div>
              <div id="mermaidBuilderContent" class="mermaid-builder-content"></div>
              <datalist id="mermaidNodeIdOptions"></datalist>
            </div>
            <section class="mermaid-preview-panel">
              <header>
                <strong>Vorschau</strong>
              </header>
              <div id="mermaidPreview" class="mermaid-preview" role="img" aria-live="polite"></div>
              <p id="mermaidPreviewStatus" class="muted mermaid-preview-status">Die Vorschau wird angezeigt, sobald gültiger Mermaid-Code vorliegt.</p>
            </section>
            <label class="mermaid-code-field">
              Mermaid-Code
              <textarea id="mermaidCodeInput" rows="12" spellcheck="false"></textarea>
              <span id="mermaidCodeHint" class="muted">Der Code wird vom Builder überschrieben, solange der graphische Editor aktiv ist.</span>
            </label>
          </div>
          <footer class="modal-footer">
            <button type="button" id="mermaidDialogCancelBtn" class="secondary">Abbrechen</button>
            <button type="submit" id="mermaidDialogInsertBtn" class="primary has-icon">
              <iconify-icon aria-hidden="true" icon="mdi:chart-timeline-variant"></iconify-icon>
              <span class="btn-label">Diagramm einfügen</span>
            </button>
          </footer>
        </form>
      </div>
    </div>

    <!-- Chat Panel -->
    <div id="chatOverlay" class="chat-overlay hidden" aria-hidden="true"></div>
    <aside id="chatPanel" class="chat-panel hidden" role="dialog" aria-label="Chat" aria-modal="true">
      <header class="chat-header">
        <strong>Chat</strong>
        <div class="spacer"></div>
        <span id="chatModelBadge" class="chat-model-badge"></span>
        <div class="spacer"></div>
        <button id="chatCloseBtn" class="icon-only" title="Schließen" aria-label="Schließen"><iconify-icon aria-hidden="true" icon="lucide:x"></iconify-icon></button>
      </header>
      
      <section id="chatMessages" class="chat-messages" aria-live="polite"></section>
      <section class="chat-input">
        <div class="chat-suggestion-toolbar">
          <nav
            id="chatSuggestionTabs"
            class="chat-suggestion-tabs"
            role="tablist"
            aria-label="Prompt-Kategorien"
          >
            <button
              type="button"
              class="active"
              role="tab"
              id="chatTabOverview"
              aria-selected="true"
              aria-controls="chatCategoryOverview"
              data-chat-category="overview"
            >
              <iconify-icon aria-hidden="true" icon="lucide:compass"></iconify-icon>
              <span>Kontext &amp; Überblick</span>
            </button>
            <button
              type="button"
              role="tab"
              id="chatTabDepth"
              aria-selected="false"
              aria-controls="chatCategoryDepth"
              data-chat-category="depth"
              tabindex="-1"
            >
              <iconify-icon aria-hidden="true" icon="lucide:search"></iconify-icon>
              <span>Vertiefendes Verständnis</span>
            </button>
            <button
              type="button"
              role="tab"
              id="chatTabTransfer"
              aria-selected="false"
              aria-controls="chatCategoryTransfer"
              data-chat-category="transfer"
              tabindex="-1"
            >
              <iconify-icon aria-hidden="true" icon="lucide:graduation-cap"></iconify-icon>
              <span>Lernen &amp; Transfer</span>
            </button>
            <button
              type="button"
              role="tab"
              id="chatTabApplication"
              aria-selected="false"
              aria-controls="chatCategoryApplication"
              data-chat-category="application"
              tabindex="-1"
            >
              <iconify-icon aria-hidden="true" icon="lucide:workflow"></iconify-icon>
              <span>Praxis &amp; Beispiele</span>
            </button>
            <button
              type="button"
              role="tab"
              id="chatTabReflection"
              aria-selected="false"
              aria-controls="chatCategoryReflection"
              data-chat-category="reflection"
              tabindex="-1"
            >
              <iconify-icon aria-hidden="true" icon="lucide:brain-circuit"></iconify-icon>
              <span>Reflexion &amp; Strategie</span>
            </button>
          </nav>
        </div>
        <ul id="chatSuggestions" class="chat-suggestions" aria-label="Vorgeschlagene Prompts">
          <li
            class="chat-suggestion-category active"
            id="chatCategoryOverview"
            role="tabpanel"
            aria-labelledby="chatTabOverview"
            aria-hidden="false"
            data-chat-category="overview"
          >
            <h4 class="sr-only">Kontext &amp; Überblick</h4>
            <div class="chat-suggestion-buttons">
              <button type="button" data-prompt="Fasse die wichtigsten Punkte zusammen. Bitte fasse die Kernaussagen knapp zusammen."><strong>Fasse die wichtigsten Punkte zusammen.</strong> Bitte fasse die Kernaussagen knapp zusammen.</button>
              <button type="button" data-prompt="Worum geht es hier? Bitte beschreibe den Kontext in wenigen Sätzen."><strong>Worum geht es hier?</strong> Bitte beschreibe den Kontext in wenigen Sätzen.</button>
              <button type="button" data-prompt="Welche offenen Fragen gibt es noch? Liste verbleibende Unklarheiten auf."><strong>Welche offenen Fragen gibt es noch?</strong> Liste verbleibende Unklarheiten auf.</button>
              <button type="button" data-prompt="Welche nächsten Schritte empfiehlst du? Formuliere konkrete To-dos."><strong>Welche nächsten Schritte empfiehlst du?</strong> Formuliere konkrete To-dos.</button>
            </div>
          </li>
          <li
            class="chat-suggestion-category"
            id="chatCategoryDepth"
            role="tabpanel"
            aria-labelledby="chatTabDepth"
            aria-hidden="true"
            data-chat-category="depth"
          >
            <h4 class="sr-only">Vertiefendes Verständnis</h4>
            <div class="chat-suggestion-buttons">
              <button type="button" data-prompt="Erkläre die wichtigsten Fach- oder Schlüsselbegriffe in diesem Abschnitt. Gib prägnante Definitionen und ergänze, warum sie hier relevant sind."><strong>Wichtige Begriffe klären.</strong> Erkläre prägnant die Schlüsselbegriffe und ihren Kontext.</button>
              <button type="button" data-prompt="Welche Annahmen oder Voraussetzungen macht der Text? Liste sie auf und beschreibe, wieso sie für das Verständnis bedeutsam sind."><strong>Annahmen identifizieren.</strong> Liste Annahmen oder Voraussetzungen und erläutere ihre Bedeutung.</button>
              <button type="button" data-prompt="Welche Hintergründe sollte ich kennen, um diesen Inhalt besser zu verstehen? Verweise auf relevante Abschnitte im Editor-Kontext oder auf allgemeines Basiswissen."><strong>Hintergründe sammeln.</strong> Beschreibe, welches Vorwissen und welche Quellen weiterhelfen.</button>
            </div>
          </li>
          <li
            class="chat-suggestion-category"
            id="chatCategoryTransfer"
            role="tabpanel"
            aria-labelledby="chatTabTransfer"
            aria-hidden="true"
            data-chat-category="transfer"
          >
            <h4 class="sr-only">Lernen &amp; Transfer</h4>
            <div class="chat-suggestion-buttons">
              <button type="button" data-prompt="Welche Wissenslücken erkennst du in Bezug auf diesen Inhalt? Erstelle einen kurzen Lernplan mit konkreten Schritten, um sie zu schließen."><strong>Lernplan erstellen.</strong> Zeige Wissenslücken und wie ich sie schließen kann.</button>
              <button type="button" data-prompt="Formuliere die Kernpunkte als Fragen-Antworten-Liste, damit ich mich selbst abfragen kann."><strong>Selbsttest vorbereiten.</strong> Erstelle eine Fragen-Antworten-Liste zu den Kernpunkten.</button>
              <button type="button" data-prompt="Vergleiche das behandelte Thema mit verwandten Konzepten. Hebe Gemeinsamkeiten, Unterschiede und typische Einsatzszenarien hervor."><strong>Konzepte vergleichen.</strong> Stelle Gemeinsamkeiten und Unterschiede zu verwandten Themen heraus.</button>
            </div>
          </li>
          <li
            class="chat-suggestion-category"
            id="chatCategoryApplication"
            role="tabpanel"
            aria-labelledby="chatTabApplication"
            aria-hidden="true"
            data-chat-category="application"
          >
            <h4 class="sr-only">Praxis &amp; Beispiele</h4>
            <div class="chat-suggestion-buttons">
              <button type="button" data-prompt="Gib mir ein konkretes Beispiel oder eine kurze Fallstudie, die zeigt, wie dieses Wissen praktisch angewendet wird. Verweise, falls sinnvoll, auf Stellen im Editor-Kontext."><strong>Konkretes Beispiel zeigen.</strong> Beschreibe eine Anwendung oder Fallstudie Schritt für Schritt.</button>
              <button type="button" data-prompt="Welche typischen Fehler passieren bei der Umsetzung dieses Themas? Beschreibe sie und gib Hinweise, wie ich sie vermeiden kann."><strong>Fehlerquellen erkennen.</strong> Zeige typische Stolperfallen und Gegenmaßnahmen.</button>
              <button type="button" data-prompt="Welche Checkliste kann ich nutzen, um das Gelernte zuverlässig im Alltag umzusetzen? Formuliere sie kompakt."><strong>Checkliste ableiten.</strong> Stelle eine kurze Umsetzungs-Checkliste zusammen.</button>
            </div>
          </li>
          <li
            class="chat-suggestion-category"
            id="chatCategoryReflection"
            role="tabpanel"
            aria-labelledby="chatTabReflection"
            aria-hidden="true"
            data-chat-category="reflection"
          >
            <h4 class="sr-only">Reflexion &amp; Strategie</h4>
            <div class="chat-suggestion-buttons">
              <button type="button" data-prompt="Welche offenen Punkte sollte ich mir für eine spätere Vertiefung merken? Erstelle eine Prioritätenliste mit kurzen Begründungen."><strong>Prioritäten setzen.</strong> Halte fest, was ich später vertiefen sollte.</button>
              <button type="button" data-prompt="Wie kann ich meinen Lernfortschritt zu diesem Thema bewerten? Nenne Kriterien und Reflexionsfragen, an denen ich mich orientieren kann."><strong>Lernfortschritt reflektieren.</strong> Gib Kriterien und Fragen zur Selbstbewertung.</button>
              <button type="button" data-prompt="Welche Strategien helfen mir, dieses Wissen längerfristig zu behalten? Empfiehl Lern- oder Wiederholungsmethoden und begründe kurz."><strong>Langfristig festigen.</strong> Empfiehl passende Wiederholungsstrategien.</button>
            </div>
          </li>
        </ul>
        <div id="chatAttachments" class="chat-attachments is-empty" aria-live="polite"></div>
        <textarea id="chatInput" rows="2" placeholder="Frage eingeben und Enter senden…"></textarea>
        <div class="row">
          <button id="chatSendBtn" class="has-icon"><iconify-icon aria-hidden="true" icon="lucide:send"></iconify-icon><span class="btn-label">Senden</span></button>
          <button id="chatFileBtn" class="secondary has-icon" type="button"><iconify-icon aria-hidden="true" icon="mdi:paperclip"></iconify-icon><span class="btn-label">Datei anhängen</span></button>
          <button id="chatAbortBtn" class="secondary has-icon" disabled><iconify-icon aria-hidden="true" icon="mdi:stop-circle-outline"></iconify-icon><span class="btn-label">Abbrechen</span></button>
          <button id="chatClearBtn" class="secondary has-icon"><iconify-icon aria-hidden="true" icon="mdi:eraser"></iconify-icon><span class="btn-label">Leeren</span></button>
          <button id="editorContextBtn" class="secondary has-icon" title="Erlaube Zugriff auf den aktuellen Editor-Inhalt"><iconify-icon aria-hidden="true" icon="mdi:file-document-outline"></iconify-icon><span class="btn-label">Editor-Kontext: EIN</span></button>
          <span id="editorContextInfo" class="muted"></span>
        </div>
        <input id="chatFileInput" type="file" hidden multiple accept=".txt,.md,.markdown,.json,.yaml,.yml,.csv,.tsv,.html,.htm,.xml,.pdf,.docx,text/*,application/json,application/x-yaml,application/pdf,application/vnd.openxmlformats-officedocument.wordprocessingml.document" />
      </section>
    </aside>

    <!-- Settings Panel -->
    <div id="settingsOverlay" class="settings-overlay hidden" aria-hidden="true"></div>
    <aside id="settingsPanel" class="settings-panel hidden" role="dialog" aria-label="Einstellungen" aria-modal="true">
      <header class="chat-header">
        <strong>Einstellungen</strong>
        <div class="spacer"></div>
        <button id="settingsCloseBtn" class="icon-only" title="Schließen" aria-label="Schließen"><iconify-icon aria-hidden="true" icon="lucide:x"></iconify-icon></button>
      </header>
      <div class="settings-body">
        <nav class="settings-nav" role="tablist" aria-orientation="vertical">
          <button class="nav-item has-icon active" data-tab="general" role="tab" aria-selected="true">
            <iconify-icon aria-hidden="true" icon="lucide:sliders-horizontal"></iconify-icon>
            <span class="btn-label">Allgemein</span>
          </button>
          <button class="nav-item has-icon" data-tab="user-context" role="tab" aria-selected="false">
            <iconify-icon aria-hidden="true" icon="lucide:user-circle"></iconify-icon>
            <span class="btn-label">Mein Kontext</span>
          </button>
          <button class="nav-item has-icon" data-tab="presets" role="tab" aria-selected="false">
            <iconify-icon aria-hidden="true" icon="lucide:sparkles"></iconify-icon>
            <span class="btn-label">KI‑Presets</span>
          </button>
          <button class="nav-item has-icon" data-tab="providers" role="tab" aria-selected="false">
            <iconify-icon aria-hidden="true" icon="lucide:server"></iconify-icon>
            <span class="btn-label">KI‑Anbieter</span>
          </button>
          <button class="nav-item has-icon" data-tab="blog" role="tab" aria-selected="false">
            <iconify-icon aria-hidden="true" icon="lucide:rss"></iconify-icon>
            <span class="btn-label">Blog</span>
          </button>
          <button class="nav-item has-icon" data-tab="info" role="tab" aria-selected="false">
            <iconify-icon aria-hidden="true" icon="lucide:info"></iconify-icon>
            <span class="btn-label">Info</span>
          </button>
          <button class="nav-item has-icon" data-tab="updates" role="tab" aria-selected="false">
            <iconify-icon aria-hidden="true" icon="lucide:git-commit"></iconify-icon>
            <span class="btn-label">Neuerungen</span>
          </button>
        </nav>
        <div class="settings-content">
        <section class="chat-settings settings-tab" data-tab="general" role="tabpanel">
            <label class="chk"><input type="checkbox" id="prefReaderInput" checked /> Reader‑Eingabe aktivieren</label>
            <label class="chk"><input type="checkbox" id="prefStickyTools" checked /> Werkzeugleisten immer sichtbar</label>
            <label class="chk"><input type="checkbox" id="prefAiInlineAutoOpen" /> KI‑Leiste beim Öffnen automatisch zeigen</label>
            <label>
              Standardansicht
              <select id="prefDefaultView" aria-label="Standardansicht">
                <option value="edit">Editor</option>
                <option value="split">Split</option>
                <option value="reader">Reader</option>
              </select>
            </label>
            <label>
              Auto-Snapshot-Intervall (Minuten)
              <input
                id="prefAutoSnapshotInterval"
                type="number"
                min="1"
                max="60"
                step="1"
                inputmode="numeric"
                value="5"
              />
              <div class="muted">Legt fest, wie oft automatisch eine Version gesichert wird (Standard: 5).</div>
            </label>
            <div class="settings-group">
              <h4>Konfiguration</h4>
              <p class="muted">Exportiere oder importiere alle Einstellungen als JSON‑Datei.</p>
              <div class="row">
                <button id="settingsConfigExportBtn" class="secondary">Konfiguration exportieren</button>
                <button id="settingsConfigImportBtn" class="secondary">Konfiguration importieren</button>
                <button id="settingsConfigResetBtn" class="secondary">Auf Standardwerte zurücksetzen</button>
                <input type="file" id="settingsConfigImportFile" accept="application/json" hidden />
              </div>
            </div>
            <div class="settings-group">
              <h4>Weiterempfehlen</h4>
              <p class="muted">
                Teile den Markdown WebEditor mit Kolleg:innen und Freund:innen oder poste den Link direkt in sozialen Netzwerken.
              </p>
              <div class="row share-buttons">
                <button id="settingsShareCopyBtn" class="secondary has-icon" type="button">
                  <iconify-icon aria-hidden="true" icon="lucide:copy"></iconify-icon>
                  <span class="btn-label">Link kopieren</span>
                </button>
                <button id="settingsShareNativeBtn" class="secondary has-icon" type="button">
                  <iconify-icon aria-hidden="true" icon="lucide:share-2"></iconify-icon>
                  <span class="btn-label">System-Share</span>
                </button>
                <button id="settingsShareTwitterBtn" class="secondary has-icon" type="button">
                  <iconify-icon aria-hidden="true" icon="ri:twitter-x-fill"></iconify-icon>
                  <span class="btn-label">Auf X teilen</span>
                </button>
                <button id="settingsShareLinkedinBtn" class="secondary has-icon" type="button">
                  <iconify-icon aria-hidden="true" icon="mdi:linkedin"></iconify-icon>
                  <span class="btn-label">Auf LinkedIn teilen</span>
                </button>
                <button id="settingsShareFacebookBtn" class="secondary has-icon" type="button">
                  <iconify-icon aria-hidden="true" icon="mdi:facebook"></iconify-icon>
                  <span class="btn-label">Auf Facebook teilen</span>
                </button>
                <button id="settingsShareWhatsappBtn" class="secondary has-icon" type="button">
                  <iconify-icon aria-hidden="true" icon="mdi:whatsapp"></iconify-icon>
                  <span class="btn-label">Auf WhatsApp teilen</span>
                </button>
                <button id="settingsShareTelegramBtn" class="secondary has-icon" type="button">
                  <iconify-icon aria-hidden="true" icon="mdi:telegram"></iconify-icon>
                  <span class="btn-label">Auf Telegram teilen</span>
                </button>
                <button id="settingsShareMastodonBtn" class="secondary has-icon" type="button">
                  <iconify-icon aria-hidden="true" icon="mdi:mastodon"></iconify-icon>
                  <span class="btn-label">Auf Mastodon teilen</span>
                </button>
                <button id="settingsShareEmailBtn" class="secondary has-icon" type="button">
                  <iconify-icon aria-hidden="true" icon="mdi:email-edit-outline"></iconify-icon>
                  <span class="btn-label">Per E-Mail senden</span>
                </button>
              </div>
            </div>
            <div class="settings-group">
              <h4>Tutorial</h4>
              <p class="muted">Starte die Einführung erneut, um Highlights und neue Bereiche noch einmal in Ruhe anzusehen.</p>
              <div class="row">
                <button id="settingsOnboardingRestartBtn" class="secondary has-icon" type="button">
                  <iconify-icon aria-hidden="true" icon="lucide:help-circle"></iconify-icon>
                  <span class="btn-label">Tutorial erneut starten</span>
                </button>
              </div>
            </div>
        </section>
        <section class="chat-settings settings-tab hidden" data-tab="user-context" role="tabpanel" aria-label="Persönlicher Kontext">
          <p id="userContextIntro" class="muted">Formuliere hier Hintergrundinfos, damit KI-Antworten besser zu dir, deinem Stil und deiner Zielgruppe passen.</p>
          <label class="chk">
            <input
              type="checkbox"
              id="prefUserContextEnabled"
              checked
              aria-describedby="userContextIntro"
              aria-controls="userContextFields"
            />
            Nutzerkontext für KI-Anfragen verwenden
          </label>
          <div id="userContextFields" class="user-context-fields">
            <div class="settings-group">
              <h4>Über mich &amp; Rolle</h4>
              <p class="muted">Beschreibe deine Position, Hintergründe oder Aufgaben, damit die KI dich richtig einordnen kann.</p>
              <textarea id="prefUserContextProfile" rows="3" placeholder="z. B. Produktmanagerin in einem SaaS-Startup, Schwerpunkt Kundenerfolg…"></textarea>
            </div>
            <div class="settings-group">
              <h4>Schreibstil &amp; Ton</h4>
              <p class="muted">Wie sollen Antworten klingen? Teile gewünschte Tonalität, Formalitätsgrad oder Sprachbesonderheiten.</p>
              <textarea id="prefUserContextStyle" rows="4" placeholder="z. B. freundlich, motivierend, gendergerechte Sprache, kurze Sätze…"></textarea>
            </div>
            <div class="settings-group">
              <h4>Zielgruppe oder Empfänger</h4>
              <p class="muted">Für wen sind die Texte gedacht? Erwähne Branche, Erfahrungslevel oder besondere Erwartungen.</p>
              <textarea id="prefUserContextAudience" rows="3" placeholder="z. B. neue Kund:innen ohne technisches Vorwissen, deutschsprachig…"></textarea>
            </div>
            <div class="settings-group">
              <h4>Besondere Hinweise</h4>
              <p class="muted">Halte Do’s &amp; Don’ts, bevorzugte Quellen oder andere Vorgaben fest.</p>
              <textarea id="prefUserContextInstructions" rows="4" placeholder="z. B. keine Emojis, immer Quellen angeben, Markdown-Listen bevorzugen…"></textarea>
            </div>
          </div>
        </section>
        <section class="chat-settings settings-tab hidden" data-tab="presets" role="tabpanel" aria-label="KI-Presets">
          <p class="muted">Presets sind gespeicherte Aufforderungen für die Assistent-Funktion. Damit kannst du wiederkehrende Aufgaben mit einem Klick auslösen.</p>
          <div class="settings-group">
            <h4>Preset</h4>
            <label>
              Preset auswählen
              <select id="settingsPresetSelect"></select>
            </label>
            <div class="row">
              <button id="settingsPresetSaveBtn" class="secondary">Speichern/Anlegen</button>
              <button id="settingsPresetNewBtn" class="secondary">Neu</button>
              <button id="settingsPresetDuplicateBtn" class="secondary">Duplizieren</button>
              <button id="settingsPresetRenameBtn" class="secondary">Umbenennen</button>
              <button id="settingsPresetDeleteBtn" class="secondary">Löschen</button>
            </div>
          </div>
          <div class="settings-group">
            <h4>Inhalt</h4>
            <label>
              Name
              <input id="settingsPresetName" type="text" placeholder="Preset-Name" />
            </label>
            <label>
              Prompt
              <textarea id="settingsPresetPrompt" rows="8" placeholder="Prompt-Text…"></textarea>
            </label>
          </div>

          <div id="settingsPresetStatus" class="muted"></div>
        </section>
          <section class="chat-settings settings-tab hidden" data-tab="providers" role="tabpanel" aria-label="KI‑Anbieter Einstellungen">
            <div class="settings-group">
              <h4>Anbieter</h4>
              <label>
                KI‑Anbieter auswählen
                <select id="aiProvider">
                  <option value="openai">OpenAI</option>
                  <option value="claude">Anthropic Claude</option>
                  <option value="ollama">Ollama (lokal)</option>
                  <option value="gemini">Google Gemini</option>
                  <option value="mistral">Mistral AI</option>
                </select>
              </label>
              <div class="row">
                <label class="chk"><input type="checkbox" id="chatStreamToggle" checked /> Stream</label>
              </div>
            </div>

            <div id="openaiSettingsGroup" class="settings-group">
              <h4>OpenAI</h4>
              <label>
                API‑Key
                <input type="password" id="openaiApiKeyInput" placeholder="sk-..." autocomplete="off" />
                <div class="muted">
                  Kein Schlüssel? <a href="https://platform.openai.com/api-keys" target="_blank" rel="noopener noreferrer">API‑Keys erstellen</a>
                </div>
              </label>
              <label>
                Basis‑URL
                <input type="url" id="openaiBaseInput" placeholder="https://api.openai.com/v1" />
              </label>
              <label>
                Modell
                <select id="openaiModelSelect"><option value="">Modelle laden…</option></select>
                <input type="text" id="openaiModelInput" placeholder="gpt-4o-mini (optional, manuell)" />
              </label>
              <div class="row">
                <button id="openaiSaveBtn" class="has-icon"><iconify-icon aria-hidden="true" icon="lucide:save"></iconify-icon><span class="btn-label">Speichern</span></button>
                <button id="openaiTestBtn" class="has-icon"><iconify-icon aria-hidden="true" icon="mdi:power-plug-outline"></iconify-icon><span class="btn-label">Verbindung testen</span></button>
              </div>
              <div id="openaiStatus" class="ollama-status" aria-live="polite"></div>
            </div>

            <div id="claudeSettingsGroup" class="settings-group" style="display: none;">
              <h4>Anthropic Claude</h4>
              <label>
                API‑Key
                <input type="password" id="claudeApiKeyInput" placeholder="sk-ant-..." autocomplete="off" />
                <div class="muted">
                  Kein Schlüssel? <a href="https://console.anthropic.com/settings/keys" target="_blank" rel="noopener noreferrer">API‑Keys erstellen</a>
                </div>
              </label>
              <label>
                Basis‑URL
                <input type="url" id="claudeBaseInput" placeholder="https://api.anthropic.com" />
              </label>
              <label>
                Modell
                <select id="claudeModelSelect"><option value="">Modelle laden…</option></select>
                <input type="text" id="claudeModelInput" placeholder="claude-3-5-sonnet-latest (optional, manuell)" />
              </label>
              <div class="row">
                <button id="claudeSaveBtn" class="has-icon"><iconify-icon aria-hidden="true" icon="lucide:save"></iconify-icon><span class="btn-label">Speichern</span></button>
                <button id="claudeTestBtn" class="has-icon"><iconify-icon aria-hidden="true" icon="mdi:power-plug-outline"></iconify-icon><span class="btn-label">Verbindung testen</span></button>
              </div>
              <div id="claudeStatus" class="ollama-status" aria-live="polite"></div>
            </div>

            <div id="ollamaSettingsGroup" class="settings-group">
              <h4>Ollama</h4>
              <label>
                Ollama URL
                <input type="url" id="ollamaUrlInput" placeholder="http://localhost:11434" />
              </label>
              <label>
                Modell
                <select id="ollamaModelSelect"><option value="">Modelle laden…</option></select>
                <input type="text" id="ollamaModelInput" placeholder="llama3.1:8b (optional, manuell)" />
              </label>
              <div class="row">
                <button id="ollamaSaveBtn" class="has-icon"><iconify-icon aria-hidden="true" icon="lucide:save"></iconify-icon><span class="btn-label">Speichern</span></button>
                <button id="ollamaTestBtn" class="has-icon"><iconify-icon aria-hidden="true" icon="mdi:power-plug-outline"></iconify-icon><span class="btn-label">Verbindung testen</span></button>
              </div>
              <div id="ollamaStatus" class="ollama-status" aria-live="polite"></div>
            </div>

            <div id="geminiSettingsGroup" class="settings-group" style="display: none;">
              <h4>Google Gemini</h4>
              <label>
                API‑Key
                <input type="password" id="geminiApiKeyInput" placeholder="AIza..." autocomplete="off" />
                <div class="muted">
                  Kein Schlüssel? <a href="https://aistudio.google.com/api-keys" target="_blank" rel="noopener noreferrer">API‑Keys erstellen</a>
                </div>
              </label>
              <label>
                Modell
                <select id="geminiModelSelect"><option value="">Modelle laden…</option></select>
                <input type="text" id="geminiModelInput" placeholder="gemini-1.5-flash (optional, manuell)" />
              </label>
              <div class="row">
                <button id="geminiSaveBtn" class="has-icon"><iconify-icon aria-hidden="true" icon="lucide:save"></iconify-icon><span class="btn-label">Speichern</span></button>
                <button id="geminiTestBtn" class="has-icon"><iconify-icon aria-hidden="true" icon="mdi:power-plug-outline"></iconify-icon><span class="btn-label">Verbindung testen</span></button>
              </div>
              <div id="geminiStatus" class="ollama-status" aria-live="polite"></div>
            </div>

            <div id="mistralSettingsGroup" class="settings-group" style="display: none;">
              <h4>Mistral AI</h4>
              <label>
                API‑Key
                <input type="password" id="mistralApiKeyInput" placeholder="mistral-xxxxxxxx" autocomplete="off" />
                <div class="muted">
                  Kein Schlüssel? <a href="https://console.mistral.ai/" target="_blank" rel="noopener noreferrer">API‑Keys erstellen</a>
                </div>
              </label>
              <label>
                Modell
                <select id="mistralModelSelect"><option value="">Modelle laden…</option></select>
                <input type="text" id="mistralModelInput" placeholder="mistral-small-latest (optional, manuell)" />
              </label>
              <div class="row">
                <button id="mistralSaveBtn" class="has-icon"><iconify-icon aria-hidden="true" icon="lucide:save"></iconify-icon><span class="btn-label">Speichern</span></button>
                <button id="mistralTestBtn" class="has-icon"><iconify-icon aria-hidden="true" icon="mdi:power-plug-outline"></iconify-icon><span class="btn-label">Verbindung testen</span></button>
              </div>
              <div id="mistralStatus" class="ollama-status" aria-live="polite"></div>
            </div>

          </section>
        <section class="chat-settings settings-tab hidden" data-tab="blog" role="tabpanel" aria-label="Blog &amp; Neuigkeiten">
          <div class="settings-group">
            <div class="blog-feed-header">
              <h4>Blog-Feed</h4>
              <button id="blogFeedRefreshBtn" class="updates-reload has-icon" type="button">
                <iconify-icon aria-hidden="true" icon="lucide:refresh-cw"></iconify-icon>
                <span class="btn-label">Neu laden</span>
              </button>
            </div>
            <div id="blogFeedStatus" class="muted" aria-live="polite">Noch kein Feed geladen.</div>
            <div id="blogFeedTimestamp" class="muted" aria-live="polite"></div>
          </div>
          <div class="settings-group">
            <ul id="blogFeedList" class="blog-feed-list"></ul>
          </div>
        </section>
        <section class="chat-settings settings-tab hidden" data-tab="info" role="tabpanel" aria-label="Info">
          <div class="info-panel">
            <img id="infoAvatar" class="info-avatar" alt="GitHub Avatar" src="" />
            <div class="info-name" id="infoName">GitHub: Anes-03</div>
            <div class="row">
              <a id="infoRepoBtn" class="btn" href="https://github.com/Anes-03/Markdown-WebEditor" target="_blank" rel="noopener noreferrer">
                <iconify-icon aria-hidden="true" icon="lucide:github"></iconify-icon>
                <span class="btn-label">Projekt‑Repository öffnen</span>
              </a>
            </div>
          </div>
          <div class="settings-group">
            <h4>App</h4>
            <div class="row" style="flex-wrap: wrap; gap: 10px;">
              <div class="muted">Theme</div>
              <div id="infoTheme"></div>
              <div class="muted">Ansicht</div>
              <div id="infoView"></div>
            </div>
            <div class="row" style="flex-wrap: wrap; gap: 10px;">
              <div class="muted">KI‑Anbieter</div>
              <div id="infoProvider"></div>
            </div>
          </div>
          <div class="settings-group">
            <h4>Tastenkürzel</h4>
            <ul class="shortcuts">
              <li>
                <span class="keys"><kbd>Cmd</kbd>/<kbd>Ctrl</kbd> + <kbd>S</kbd></span>
                <span class="desc">Speichern</span>
              </li>
              <li>
                <span class="keys"><kbd>Shift</kbd> + <kbd>Cmd</kbd>/<kbd>Ctrl</kbd> + <kbd>S</kbd></span>
                <span class="desc">Speichern unter</span>
              </li>
              <li>
                <span class="keys"><kbd>Cmd</kbd>/<kbd>Ctrl</kbd> + <kbd>O</kbd></span>
                <span class="desc">Öffnen</span>
              </li>
              <li>
                <span class="keys"><kbd>Cmd</kbd>/<kbd>Ctrl</kbd> + <kbd>N</kbd></span>
                <span class="desc">Neu</span>
              </li>
              <li>
                <span class="keys"><kbd>Cmd</kbd>/<kbd>Ctrl</kbd> + <kbd>B</kbd></span>
                <span class="desc">Fett</span>
              </li>
              <li>
                <span class="keys"><kbd>Cmd</kbd>/<kbd>Ctrl</kbd> + <kbd>I</kbd></span>
                <span class="desc">Kursiv</span>
              </li>
              <li>
                <span class="keys"><kbd>Cmd</kbd>/<kbd>Ctrl</kbd> + <kbd>K</kbd></span>
                <span class="desc">Link einfügen</span>
              </li>
              <li>
                <span class="keys"><kbd>Cmd</kbd>/<kbd>Ctrl</kbd> + <kbd>G</kbd> oder <kbd>Cmd</kbd>/<kbd>Ctrl</kbd> + <kbd>Enter</kbd></span>
                <span class="desc">KI generieren</span>
              </li>
              <li>
                <span class="keys"><kbd>Cmd</kbd>/<kbd>Ctrl</kbd> + <kbd>Z</kbd></span>
                <span class="desc">Rückgängig</span>
              </li>
              <li>
                <span class="keys"><kbd>Shift</kbd> + <kbd>Cmd</kbd>/<kbd>Ctrl</kbd> + <kbd>Z</kbd></span>
                <span class="desc">Wiederholen</span>
              </li>
            </ul>
          </div>
          <div class="settings-group">
            <h4>Hinweise & Datenschutz</h4>
            <ul>
              <li>Deine Dokumente bleiben lokal im Browser, Autosave nutzt LocalStorage.</li>
              <li>Beim Einbetten von Bildern werden Daten‑URLs im Dokument gespeichert.</li>
              <li>KI‑Funktionen senden Inhalte an den gewählten Anbieter (z. B. Ollama lokal, OpenAI, Claude, Gemini oder Mistral), sofern aktiviert.</li>
            </ul>
          </div>
          <div class="settings-group">
            <h4>Credits</h4>
            <ul>
              <li>Markdown: marked</li>
              <li>Sicherheit: DOMPurify</li>
              <li>Syntax‑Highlighting: highlight.js</li>
              <li>PDF Export: html2pdf.js</li>
              <li>Icons: Iconify</li>
            </ul>
          </div>
          <div class="settings-group">
            <h4>Feedback</h4>
            <form id="feedbackForm" class="feedback-form">
              <div class="form-row">
                <label for="feedbackName">Name</label>
                <input type="text" id="feedbackName" name="name" placeholder="Dein Name" autocomplete="name" />
              </div>
              <div class="form-row">
                <label for="feedbackEmail">E‑Mail</label>
                <input type="email" id="feedbackEmail" name="email" placeholder="deine@mail.de" autocomplete="email" />
              </div>
              <div class="form-row">
                <label for="feedbackMessage">Nachricht<span aria-hidden="true">*</span></label>
                <textarea id="feedbackMessage" name="message" rows="4" required placeholder="Dein Feedback…"></textarea>
              </div>
              <button type="submit" id="feedbackSubmit" class="secondary">Feedback senden</button>
            </form>
            <div id="feedbackHint" class="muted">Beim Senden wird dein Mail‑Programm mit allen Angaben geöffnet.</div>
          </div>
        </section>
        <section id="updatesPanel" class="chat-settings settings-tab hidden" data-tab="updates" role="tabpanel" aria-label="Neuerungen">
          <div class="settings-group updates-group">
            <div class="updates-header">
              <h4>Aktuelle Änderungen</h4>
              <span id="updatesStatus" class="muted" aria-live="polite">Noch nicht geladen.</span>
            </div>
            <ol id="updatesList" class="updates-list" aria-live="polite"></ol>
            <button id="updatesReloadBtn" class="updates-reload has-icon" type="button">
              <iconify-icon aria-hidden="true" icon="lucide:refresh-cw"></iconify-icon>
              <span class="btn-label">Neu laden</span>
            </button>
          </div>
        </section>
        </div>
      </div>
      <footer class="settings-footer">
        <div class="spacer"></div>
        <button id="settingsSaveBtn">Speichern</button>
      </footer>
    </aside>

    <div id="websiteOverlay" class="website-overlay hidden" aria-hidden="true"></div>
    <div id="learningOverlay" class="website-overlay hidden" aria-hidden="true"></div>
    <aside
      id="websiteModal"
      class="website-modal hidden"
      role="dialog"
      aria-modal="true"
      aria-labelledby="websiteModalTitle"
      aria-hidden="true"
      tabindex="-1"
    >
      <header class="chat-header">
        <strong id="websiteModalTitle">Website-Vorschau</strong>
        <div class="spacer"></div>
        <button id="websiteCloseBtn" class="icon-only" title="Schließen" aria-label="Schließen">
          <iconify-icon aria-hidden="true" icon="lucide:x"></iconify-icon>
        </button>
      </header>
      <div class="website-modal-body">
        <p id="websiteStatus" class="website-status" aria-live="polite">Die KI erstellt eine Vorschau für deine Website…</p>
        <div class="website-preview-wrapper">
          <iframe
            id="websitePreviewFrame"
            title="Generierte Website-Vorschau"
            sandbox="allow-same-origin"
          ></iframe>
        </div>
      </div>
      <footer class="website-modal-footer">
        <div class="website-modal-footer-group">
          <button id="websiteCopyHtmlBtn" class="secondary has-icon" type="button">
            <iconify-icon aria-hidden="true" icon="lucide:copy"></iconify-icon>
            <span class="btn-label">Code kopieren</span>
          </button>
          <button id="websiteDownloadBtn" class="secondary has-icon" type="button">
            <iconify-icon aria-hidden="true" icon="lucide:download"></iconify-icon>
            <span class="btn-label">Als Datei herunterladen</span>
          </button>
        </div>
        <div class="spacer"></div>
        <div class="website-modal-footer-group">
          <button id="websiteRegenerateBtn" class="secondary has-icon" type="button">
            <iconify-icon aria-hidden="true" icon="mdi:refresh"></iconify-icon>
            <span class="btn-label">Neu generieren</span>
          </button>
          <button id="websiteCloseFooterBtn" class="has-icon" type="button">
            <iconify-icon aria-hidden="true" icon="lucide:check"></iconify-icon>
            <span class="btn-label">Fertig</span>
          </button>
        </div>
      </footer>
    </aside>
    <aside
      id="learningModal"
      class="website-modal hidden"
      role="dialog"
      aria-modal="true"
      aria-labelledby="learningModalTitle"
      aria-hidden="true"
      tabindex="-1"
    >
      <header class="chat-header">
        <strong id="learningModalTitle">Lernmodus-Vorschau</strong>
        <span id="learningModeLabel" class="chat-model-badge" hidden></span>
        <div class="spacer"></div>
        <button
          id="learningFullscreenBtn"
          class="icon-only"
          title="Vorschau maximieren"
          aria-label="Vorschau maximieren"
          aria-pressed="false"
        >
          <iconify-icon aria-hidden="true" icon="lucide:maximize-2"></iconify-icon>
        </button>
        <button id="learningCloseBtn" class="icon-only" title="Schließen" aria-label="Schließen">
          <iconify-icon aria-hidden="true" icon="lucide:x"></iconify-icon>
        </button>
      </header>
      <div class="website-modal-body">
        <p id="learningStatus" class="website-status" aria-live="polite">Die KI baut eine interaktive Lernansicht…</p>
        <div class="website-preview-wrapper">
          <iframe
            id="learningPreviewFrame"
            title="Vorschau der Lerninhalte"
            sandbox="allow-same-origin allow-scripts"
          ></iframe>
        </div>
      </div>
      <footer class="website-modal-footer">
        <div class="website-modal-footer-group">
          <button id="learningCopyHtmlBtn" class="secondary has-icon" type="button">
            <iconify-icon aria-hidden="true" icon="lucide:copy"></iconify-icon>
            <span class="btn-label">Code kopieren</span>
          </button>
          <button id="learningDownloadBtn" class="secondary has-icon" type="button">
            <iconify-icon aria-hidden="true" icon="lucide:download"></iconify-icon>
            <span class="btn-label">Als Datei herunterladen</span>
          </button>
        </div>
        <div class="spacer"></div>
        <div class="website-modal-footer-group">
          <button id="learningRegenerateBtn" class="secondary has-icon" type="button">
            <iconify-icon aria-hidden="true" icon="mdi:refresh"></iconify-icon>
            <span class="btn-label">Neu generieren</span>
          </button>
          <button id="learningCloseFooterBtn" class="has-icon" type="button">
            <iconify-icon aria-hidden="true" icon="lucide:check"></iconify-icon>
            <span class="btn-label">Fertig</span>
          </button>
        </div>
      </footer>
    </aside>
    <script src="data/templates.js"></script>
    <script src="app.js"></script>
  </body>
</html>
